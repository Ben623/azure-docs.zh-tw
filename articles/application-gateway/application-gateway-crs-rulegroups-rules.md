---
title: Azure 應用程式閘道 Web 應用程式防火牆 CRS 規則群組與規則
description: 此頁面提供關於 Web 應用程式防火牆 CRS 規則群組與規則的資訊。
services: application-gateway
author: vhorne
ms.service: application-gateway
ms.date: 4/11/2019
ms.author: victorh
ms.openlocfilehash: 0ad5cc76c0f4631fd60eea7d0a57e4740b6a9db3
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/13/2019
ms.locfileid: "60832909"
---
# <a name="web-application-firewall-crs-rule-groups-and-rules"></a>Web 應用程式防火牆 CRS 規則群組與規則

應用程式閘道 web 應用程式防火牆 (WAF) 會保護 web 應用程式免於一般安全性弱點和攻擊。 這是透過定義的規則根據 OWASP 核心規則集 3.0 或 2.2.9。 可依規則基礎在規則上停用這些規則。 這篇文章包含目前的規則和提供的規則集。

當使用應用程式閘道 web 應用程式防火牆，會出現下列規則群組和規則。

# <a name="owasp-30tabowasp3"></a>[OWASP 3.0](#tab/owasp3)

## <a name="owasp30"></a> 規則集

### <a name="General"></a> <p x-ms-format-detection="none">一般</p>

|RuleId|描述|
|---|---|
|200004|可能的多組件不相符的界限。|

### <a name="crs911"></a> <p x-ms-format-detection="none">REQUEST-911-METHOD-ENFORCEMENT</p>

|RuleId|描述|
|---|---|
|911100|原則不允許方法|


### <a name="crs913"></a> <p x-ms-format-detection="none">REQUEST-913-SCANNER-DETECTION</p>

|RuleId|描述|
|---|---|
|913100|找到與安全性掃描程式相關聯的使用者代理程式|
|913110|找到與安全性掃描程式相關聯的要求標頭|
|913120|找到與安全性掃描程式相關聯的要求檔名/引數|
|913101|找到與指令碼/一般 HTTP 用戶端相關聯的使用者代理程式|
|913102|找到與 web 編目程式/bot 相關聯的使用者代理程式|

### <a name="crs920"></a> <p x-ms-format-detection="none">REQUEST-920-PROTOCOL-ENFORCEMENT</p>

|RuleId|描述|
|---|---|
|920100|無效的 HTTP 要求列|
|920130|無法剖析要求內文。|
|920140|多部分要求內文的嚴格驗證失敗|
|920160|內容長度 HTTP 標頭不是數值。|
|920170|具有內文內容的 GET 或 HEAD 要求。|
|920180|POST 要求遺失 Content-Length 標頭。|
|920190|範圍 = 無效的最後一個位元組值。|
|920210|找到多個/衝突連接標頭資料。|
|920220|URL 編碼濫用攻擊嘗試|
|920240|URL 編碼濫用攻擊嘗試|
|920250|UTF8 編碼濫用攻擊嘗試|
|920260|Unicode 全/半寬度濫用攻擊嘗試|
|920270|要求 (null 字元) 中的字元無效|
|920280|要求遺失主機標頭|
|920290|空白的主機標頭|
|920310|要求具有空白的 Accept 標頭|
|920311|要求具有空白的 Accept 標頭|
|920330|空白的使用者代理程式標頭|
|920340|要求包含內容，但遺漏 Content-type 標頭|
|920350|主機標頭是數字的 IP 位址|
|920380|要求中的引數太多|
|920360|引數名稱太長|
|920370|引數值太長|
|920390|超過總引數大小|
|920400|上傳的檔案大小太大|
|920410|上傳的檔案大小總數太大|
|920420|原則不允許要求內容類型|
|920430|原則不允許 HTTP 通訊協定版本|
|920440|原則會限制 URL 的副檔名|
|920450|原則會限制 HTTP 標頭 (%@{MATCHED_VAR})|
|920200|範圍 = 太多欄位 (6 個或以上)|
|920201|範圍 = 太多 pdf 要求的欄位 (35 個或以上)|
|920230|偵測到多個 URL 編碼|
|920300|要求遺失 Accept 標頭|
|920271|要求 (非可列印的字元) 中的字元無效|
|920320|遺失使用者代理程式標頭|
|920272|要求 (在 ASCII 127 下方的可列印字元之外) 中的字元無效|
|920202|範圍 = 太多 pdf 要求的欄位 (6 個或以上)|
|920273|要求 (非常嚴格的設定之外) 中的字元無效|
|920274|要求標頭 (非常嚴格的設定之外) 中的字元無效|
|920460|異常的逸出字元|

### <a name="crs921"></a> <p x-ms-format-detection="none">REQUEST-921-PROTOCOL-ATTACK</p>

|RuleId|描述|
|---|---|
|921100|HTTP 要求走私攻擊。|
|921110|HTTP 要求走私攻擊|
|921120|HTTP 回應分割攻擊|
|921130|HTTP 回應分割攻擊|
|921140|透過標頭的 HTTP 標頭插入式攻擊|
|921150|透過承載 (偵測到 CR/LF) 的 HTTP 標頭插入式攻擊|
|921160|透過承載 (偵測到 CR/LF 和 header-name) 的 HTTP 標頭插入式攻擊|
|921151|透過承載 (偵測到 CR/LF) 的 HTTP 標頭插入式攻擊|
|921170|HTTP 參數侵害|
|921180|HTTP 參數侵害 (%@{TX.1})|

### <a name="crs930"></a> <p x-ms-format-detection="none">REQUEST-930-APPLICATION-ATTACK-LFI</p>

|RuleId|描述|
|---|---|
|930100|路徑周遊攻擊 (/../)|
|930110|路徑周遊攻擊 (/../)|
|930120|作業系統檔案存取嘗試|
|930130|受限制檔案存取嘗試|

### <a name="crs931"></a> <p x-ms-format-detection="none">REQUEST-931-APPLICATION-ATTACK-RFI</p>

|RuleId|描述|
|---|---|
|931100|可能的遠端檔案包含 (RFI) 攻擊 = 使用 IP 位址的 URL 參數|
|931110|可能的遠端檔案包含 (RFI) 攻擊 = 與 URL 承載搭配使用的一般 RFI 易受攻擊參數名稱|
|931120|可能的遠端檔案包含 (RFI) 攻擊 = 與結尾問號字元 (?) 搭配使用 URL 承載|
|931130|可能的遠端檔案包含 (RFI) 攻擊 = 關閉網域參考/連結|

### <a name="crs932"></a> <p x-ms-format-detection="none">REQUEST-932-APPLICATION-ATTACK-RCE</p>

|RuleId|描述|
|---|---|
|932120|遠端命令執行 = 找到 Windows PowerShell 命令|
|932130|遠端命令執行 = 找到 Unix 殼層運算式|
|932140|遠端命令執行 = 找到 Windows FOR/IF 命令|
|932160|遠端命令執行 = 找到 Unix 殼層程式碼|
|932170|執行遠端命令 = Shellshock (CVE-2014-6271)|
|932171|執行遠端命令 = Shellshock (CVE-2014-6271)|

### <a name="crs933"></a> <p x-ms-format-detection="none">REQUEST-933-APPLICATION-ATTACK-PHP</p>

|RuleId|描述|
|---|---|
|933100|PHP 插入式攻擊 = 找到開頭/結尾標記|
|933110|PHP 插入式攻擊 = 找到 PHP 指令碼檔案上傳|
|933120|PHP 插入式攻擊 = 找到組態指示詞|
|933130|PHP 插入式攻擊 = 找到變數|
|933150|PHP 插入式攻擊 = 找到高風險 PHP 函式名稱|
|933160|PHP 插入式攻擊 = 找到高風險 PHP 函式呼叫|
|933180|PHP 插入式攻擊 = 找到變數函式呼叫|
|933151|PHP 插入式攻擊 = 找到中度風險 PHP 函式名稱|
|933131|PHP 插入式攻擊 = 找到變數|
|933161|PHP 插入式攻擊 = 找到低價值 PHP 函式呼叫|
|933111|PHP 插入式攻擊 = 找到 PHP 指令碼檔案上傳|

### <a name="crs941"></a> <p x-ms-format-detection="none">REQUEST-941-APPLICATION-ATTACK-XSS</p>

|RuleId|描述|
|---|---|
|941100|透過 libinjection 偵測到的 XSS 攻擊|
|941110|XSS 篩選器 - 類別 1 = 指令碼標記向量|
|941130|XSS 篩選器 - 類別 3 = 屬性向量|
|941140|XSS 篩選器 - 類別 4 = JavaScript URI 向量|
|941150|XSS 篩選器 - 類別 5 = 不允許的 HTML 屬性|
|941180|節點狀態驗證黑名單關鍵字|
|941190|使用樣式表的 XSS|
|941200|XSS 使用 VML 畫面格|
|941210|XSS 使用經過混淆處理的 Javascript|
|941220|使用的 XSS 混淆的 VB 指令碼|
|941230|使用的 XSS 的 '內嵌' 標籤|
|941240|使用 'import' 或 'implementation' 屬性的 XSS|
|941260|使用 'meta' 標記的 XSS|
|941270|使用 'l' href 的 XSS|
|941280|使用 'base' 標記的 XSS|
|941290|使用 'applet' 標記的 XSS|
|941300|使用 'object' 標記的 XSS|
|941310|US-ASCII 格式不正確編碼 XSS 篩選器 - 偵測到攻擊。|
|941330|IE XSS 篩選器 - 偵測到攻擊。|
|941340|IE XSS 篩選器 - 偵測到攻擊。|
|941350|UTF-7 編碼 IE XSS - 偵測到攻擊。|
|941320|偵測到可能的 XSS 攻擊 - HTML 標記處理常式|

### <a name="crs942"></a> <p x-ms-format-detection="none">REQUEST-942-APPLICATION-ATTACK-SQLI</p>

|RuleId|描述|
|---|---|
|942100|透過 libinjection 偵測到的 SQL 插入式攻擊|
|942110|SQL 插入式攻擊：已偵測到一般插入測試|
|942130|SQL 插入式攻擊：檢測到 SQL 恆真式。|
|942140|SQL 插入式攻擊 = 偵測到常用的 DB 名稱|
|942160|偵測到使用 sleep() 或 benchmark() 的盲人 sqli 測試。|
|942170|偵測到 SQL 基準測試與睡眠插入式嘗試包括條件式查詢|
|942190|偵測到 MSSQL 程式碼執行和資訊收集嘗試次數|
|942200|偵測到 MySQL 註解/空間模糊化的插入和反引號終止|
|942230|偵測到條件式 SQL 插入嘗試|
|942260|偵測到基本 SQL 驗證略過嘗試 2/3|
|942270|尋找基本的 SQL 插入。 MySQL Oracle 和其他的常見攻擊字串。|
|942290|尋找基本 MongoDB SQL 插入嘗試|
|942300|偵測到 MySQL 註解、條件和 ch(a)r 插入|
|942320|偵測到 MySQL 與 PostgreSQL 預存程序/函式插入|
|942330|偵測到傳統 SQL 插入探測 1/2|
|942340|偵測到基本 SQL 驗證略過嘗試 3/3|
|942350|偵測到 MySQL UDF 插入和其他資料/結構操作嘗試|
|942360|偵測到連續的基本 SQL 插入和 SQLLFI 嘗試次數|
|942370|偵測到傳統 SQL 插入探測 2/2|
|942150|SQL 插入式攻擊|
|942410|SQL 插入式攻擊|
|942430|受限制的 SQL 字元異常偵測 (args)：超出的特殊字元數目 (12)|
|942440|偵測到 SQL 註解順序。|
|942450|識別到 SQL 十六進位編碼|
|942251|偵測到 HAVING 插入|
|942460|中繼字元異常偵測警示 - 重複性的非文字字元|

### <a name="crs943"></a> <p x-ms-format-detection="none">REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION</p>

|RuleId|描述|
|---|---|
|943100|可能的工作階段 Fixation 攻擊 = 在 HTML 中設定 Cookie 值|
|943110|可能的工作階段 Fixation 攻擊 = 具有關閉網域查閱者的工作階段識別碼參數名稱|
|943120|可能的工作階段 Fixation 攻擊 = 沒有查閱者的工作階段識別碼參數名稱|

# <a name="owasp-229tabowasp2"></a>[OWASP 2.2.9](#tab/owasp2)

## <a name="owasp229"></a> 規則集

### <a name="crs20"></a> crs_20_protocol_violations

|RuleId|描述|
|---|---|
|960911|無效的 HTTP 要求列|
|981227|Apache 錯誤 = 要求中無效的 URI。|
|960912|無法剖析要求內文。|
|960914|多部分要求內文的嚴格驗證失敗|
|960915|多部分剖析偵測到可能的不相符界限。|
|960016|內容長度 HTTP 標頭不是數值。|
|960011|具有內文內容的 GET 或 HEAD 要求。|
|960012|POST 要求遺失 Content-Length 標頭。|
|960902|使用無效的身分識別編碼。|
|960022|HTTP 1.0 不允許預期標頭。|
|960020|Pragma 標頭需要 HTTP/1.1 要求的快取控制標頭。|
|958291|範圍 = 欄位存在且是以 0 開頭。|
|958230|範圍 = 無效的最後一個位元組值。|
|958295|找到多個/衝突連接標頭資料。|
|950107|URL 編碼濫用攻擊嘗試|
|950109|偵測到多個 URL 編碼|
|950108|URL 編碼濫用攻擊嘗試|
|950801|UTF8 編碼濫用攻擊嘗試|
|950116|Unicode 全/半寬度濫用攻擊嘗試|
|960901|要求中的字元無效|
|960018|要求中的字元無效|

### <a name="crs21"></a> crs_21_protocol_anomalies

|RuleId|描述|
|---|---|
|960008|要求遺失主機標頭|
|960007|空白的主機標頭|
|960015|要求遺失 Accept 標頭|
|960021|要求具有空白的 Accept 標頭|
|960009|要求遺漏使用者代理程式標頭|
|960006|空白的使用者代理程式標頭|
|960904|要求包含內容，但遺漏 Content-type 標頭|
|960017|主機標頭是數字的 IP 位址|

### <a name="crs23"></a> crs_23_request_limits

|RuleId|描述|
|---|---|
|960209|引數名稱太長|
|960208|引數值太長|
|960335|要求中的引數太多|
|960341|超過總引數大小|
|960342|上傳的檔案大小太大|
|960343|上傳的檔案大小總數太大|

### <a name="crs30"></a> crs_30_http_policy

|RuleId|描述|
|---|---|
|960032|原則不允許方法|
|960010|原則不允許要求內容類型|
|960034|原則不允許 HTTP 通訊協定版本|
|960035|原則會限制 URL 的副檔名|
|960038|原則會限制 HTTP 標頭|

### <a name="crs35"></a> crs_35_bad_robots

|RuleId|描述|
|---|---|
|990002|要求會指出安全性掃描程式掃描的網站|
|990901|要求會指出安全性掃描程式掃描的網站|
|990902|要求會指出安全性掃描程式掃描的網站|
|990012|惡意網站編目程式|

### <a name="crs40"></a> crs_40_generic_attacks

|RuleId|描述|
|---|---|
|960024|中繼字元異常偵測警示 - 重複性的非文字字元|
|950008|插入未記載的 ColdFusion 標記|
|950010|LDAP 插入式攻擊|
|950011|SSI 插入式攻擊|
|950018|偵測到通用 PDF XSS URL。|
|950019|電子郵件插入式攻擊|
|950012|HTTP 要求走私攻擊。|
|950910|HTTP 回應分割攻擊|
|950911|HTTP 回應分割攻擊|
|950117|遠端檔案包含攻擊|
|950118|遠端檔案包含攻擊|
|950119|遠端檔案包含攻擊|
|950120|可能的遠端檔案包含 (RFI) 攻擊 = 關閉網域參考/連結|
|981133|規則 981133|
|981134|規則 981134|
|950009|工作階段 Fixation 攻擊|
|950003|工作階段 Fixation|
|950000|工作階段 Fixation|
|950005|遠端檔案存取嘗試|
|950002|系統命令存取|
|950006|系統命令插入|
|959151|PHP 插入式攻擊|
|958976|PHP 插入式攻擊|
|958977|PHP 插入式攻擊|

### <a name="crs41sql"></a> crs_41_sql_injection_attacks

|RuleId|描述|
|---|---|
|981231|偵測到 SQL 註解順序。|
|981260|識別到 SQL 十六進位編碼|
|981320|SQL 插入式攻擊 = 偵測到常用的 DB 名稱|
|981300|規則 981300|
|981301|規則 981301|
|981302|規則 981302|
|981303|規則 981303|
|981304|規則 981304|
|981305|規則 981305|
|981306|規則 981306|
|981307|規則 981307|
|981308|規則 981308|
|981309|規則 981309|
|981310|規則 981310|
|981311|規則 981311|
|981312|規則 981312|
|981313|規則 981313|
|981314|規則 981314|
|981315|規則 981315|
|981316|規則 981316|
|981317|SQL SELECT 陳述式的異常偵測警示|
|950007|密件 SQL 插入式攻擊|
|950001|SQL 插入式攻擊|
|950908|SQL 插入式攻擊。|
|959073|SQL 插入式攻擊|
|981272|偵測到使用 sleep() 或 benchmark() 的盲人 sqli 測試。|
|981250|偵測到 SQL 基準測試與睡眠插入式嘗試包括條件式查詢|
|981241|偵測到條件式 SQL 插入嘗試|
|981276|尋找基本的 SQL 插入。 MySQL Oracle 和其他的常見攻擊字串。|
|981270|尋找基本 MongoDB SQL 插入嘗試|
|981253|偵測到 MySQL 與 PostgreSQL 預存程序/函式插入|
|981251|偵測到 MySQL UDF 插入和其他資料/結構操作嘗試|

### <a name="crs41xss"></a> crs_41_xss_attacks

|RuleId|描述|
|---|---|
|973336|XSS 篩選器 - 類別 1 = 指令碼標記向量|
|973338|XSS 篩選器 - 類別 3 = JavaScript URI 向量|
|981136|規則 981136|
|981018|規則 981018|
|958016|跨網站指令碼 (XSS) 攻擊|
|958414|跨網站指令碼 (XSS) 攻擊|
|958032|跨網站指令碼 (XSS) 攻擊|
|958026|跨網站指令碼 (XSS) 攻擊|
|958027|跨網站指令碼 (XSS) 攻擊|
|958054|跨網站指令碼 (XSS) 攻擊|
|958418|跨網站指令碼 (XSS) 攻擊|
|958034|跨網站指令碼 (XSS) 攻擊|
|958019|跨網站指令碼 (XSS) 攻擊|
|958013|跨網站指令碼 (XSS) 攻擊|
|958408|跨網站指令碼 (XSS) 攻擊|
|958012|跨網站指令碼 (XSS) 攻擊|
|958423|跨網站指令碼 (XSS) 攻擊|
|958002|跨網站指令碼 (XSS) 攻擊|
|958017|跨網站指令碼 (XSS) 攻擊|
|958007|跨網站指令碼 (XSS) 攻擊|
|958047|跨網站指令碼 (XSS) 攻擊|
|958410|跨網站指令碼 (XSS) 攻擊|
|958415|跨網站指令碼 (XSS) 攻擊|
|958022|跨網站指令碼 (XSS) 攻擊|
|958405|跨網站指令碼 (XSS) 攻擊|
|958419|跨網站指令碼 (XSS) 攻擊|
|958028|跨網站指令碼 (XSS) 攻擊|
|958057|跨網站指令碼 (XSS) 攻擊|
|958031|跨網站指令碼 (XSS) 攻擊|
|958006|跨網站指令碼 (XSS) 攻擊|
|958033|跨網站指令碼 (XSS) 攻擊|
|958038|跨網站指令碼 (XSS) 攻擊|
|958409|跨網站指令碼 (XSS) 攻擊|
|958001|跨網站指令碼 (XSS) 攻擊|
|958005|跨網站指令碼 (XSS) 攻擊|
|958404|跨網站指令碼 (XSS) 攻擊|
|958023|跨網站指令碼 (XSS) 攻擊|
|958010|跨網站指令碼 (XSS) 攻擊|
|958411|跨網站指令碼 (XSS) 攻擊|
|958422|跨網站指令碼 (XSS) 攻擊|
|958036|跨網站指令碼 (XSS) 攻擊|
|958000|跨網站指令碼 (XSS) 攻擊|
|958018|跨網站指令碼 (XSS) 攻擊|
|958406|跨網站指令碼 (XSS) 攻擊|
|958040|跨網站指令碼 (XSS) 攻擊|
|958052|跨網站指令碼 (XSS) 攻擊|
|958037|跨網站指令碼 (XSS) 攻擊|
|958049|跨網站指令碼 (XSS) 攻擊|
|958030|跨網站指令碼 (XSS) 攻擊|
|958041|跨網站指令碼 (XSS) 攻擊|
|958416|跨網站指令碼 (XSS) 攻擊|
|958024|跨網站指令碼 (XSS) 攻擊|
|958059|跨網站指令碼 (XSS) 攻擊|
|958417|跨網站指令碼 (XSS) 攻擊|
|958020|跨網站指令碼 (XSS) 攻擊|
|958045|跨網站指令碼 (XSS) 攻擊|
|958004|跨網站指令碼 (XSS) 攻擊|
|958421|跨網站指令碼 (XSS) 攻擊|
|958009|跨網站指令碼 (XSS) 攻擊|
|958025|跨網站指令碼 (XSS) 攻擊|
|958413|跨網站指令碼 (XSS) 攻擊|
|958051|跨網站指令碼 (XSS) 攻擊|
|958420|跨網站指令碼 (XSS) 攻擊|
|958407|跨網站指令碼 (XSS) 攻擊|
|958056|跨網站指令碼 (XSS) 攻擊|
|958011|跨網站指令碼 (XSS) 攻擊|
|958412|跨網站指令碼 (XSS) 攻擊|
|958008|跨網站指令碼 (XSS) 攻擊|
|958046|跨網站指令碼 (XSS) 攻擊|
|958039|跨網站指令碼 (XSS) 攻擊|
|958003|跨網站指令碼 (XSS) 攻擊|
|973300|偵測到可能的 XSS 攻擊 - HTML 標記處理常式|
|973301|偵測到 XSS 攻擊|
|973302|偵測到 XSS 攻擊|
|973303|偵測到 XSS 攻擊|
|973304|偵測到 XSS 攻擊|
|973305|偵測到 XSS 攻擊|
|973306|偵測到 XSS 攻擊|
|973307|偵測到 XSS 攻擊|
|973308|偵測到 XSS 攻擊|
|973309|偵測到 XSS 攻擊|
|973311|偵測到 XSS 攻擊|
|973313|偵測到 XSS 攻擊|
|973314|偵測到 XSS 攻擊|
|973331|IE XSS 篩選器 - 偵測到攻擊。|
|973315|IE XSS 篩選器 - 偵測到攻擊。|
|973330|IE XSS 篩選器 - 偵測到攻擊。|
|973327|IE XSS 篩選器 - 偵測到攻擊。|
|973326|IE XSS 篩選器 - 偵測到攻擊。|
|973346|IE XSS 篩選器 - 偵測到攻擊。|
|973345|IE XSS 篩選器 - 偵測到攻擊。|
|973324|IE XSS 篩選器 - 偵測到攻擊。|
|973323|IE XSS 篩選器 - 偵測到攻擊。|
|973348|IE XSS 篩選器 - 偵測到攻擊。|
|973321|IE XSS 篩選器 - 偵測到攻擊。|
|973320|IE XSS 篩選器 - 偵測到攻擊。|
|973318|IE XSS 篩選器 - 偵測到攻擊。|
|973317|IE XSS 篩選器 - 偵測到攻擊。|
|973329|IE XSS 篩選器 - 偵測到攻擊。|
|973328|IE XSS 篩選器 - 偵測到攻擊。|

### <a name="crs42"></a> crs_42_tight_security

|RuleId|描述|
|---|---|
|950103|路徑周遊攻擊|

### <a name="crs45"></a> crs_45_trojans

|RuleId|描述|
|---|---|
|950110|後門程式存取|
|950921|後門程式存取|
|950922|後門程式存取|

---

## <a name="next-steps"></a>後續步驟

了解如何停用 WAF 規則：[自訂 WAF 規則](application-gateway-customize-waf-rules-portal.md)