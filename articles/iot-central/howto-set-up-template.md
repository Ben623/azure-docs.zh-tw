---
title: 在 Azure IoT Central 應用程式中設定裝置範本 | Microsoft Docs
description: 了解如何使用量測、設定、屬性、規則和儀表板來設定裝置範本。
author: viv-liu
ms.author: viviali
ms.date: 06/19/2019
ms.topic: conceptual
ms.service: iot-central
services: iot-central
manager: peterpr
ms.openlocfilehash: d27fd9460685c08a2b13936415935f5aaf893797
ms.sourcegitcommit: dda9fc615db84e6849963b20e1dce74c9fe51821
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/08/2019
ms.locfileid: "67622401"
---
# <a name="set-up-a-device-template"></a>設定裝置範本

裝置範本是一份藍圖，可為連線至 Azure IoT Central 應用程式的某種裝置，定義其所具有的特性和行為。

比方說，產生器可以建立具有下列特性的連線風扇的裝置範本：

- 溫度遙測量測
- 位置度量
- 風扇馬達錯誤事件量測
- 風扇運轉狀態量測
- 風扇速度設定
- 可傳送警示的規則
- 可讓您檢視裝置整體的儀表板

透過此裝置範本，操作員可以使用 **fan-1** 和 **fan-2** 等名稱，建立真實的風扇裝置並將其連網。 所有這些風扇都有量測、設定、屬性、規則和儀表板，可供應用程式使用者監視和管理。

> [!NOTE]
> 只有建置者和系統管理員可以建立、編輯和刪除裝置範本。 任何使用者都可以在 [Device Explorer]  頁面，透過現有裝置範本來建立裝置。

## <a name="create-a-device-template"></a>建立裝置範本

1. 瀏覽至 [裝置範本]  頁面。

2. 若要建立範本，請先選取 **+ 新增**。

3. 若要快速開始，選擇現有預先建置的範本。 否則，請選取**自訂**，輸入名稱，然後按一下**建立**來建置您自己的範本，從零開始。

   ![裝置範本程式庫](./media/howto-set-up-template/newtemplate.png)

4. 當您建立自訂範本時，您會看到**裝置詳細資料**新裝置範本的頁面。 當您建立裝置範本時，IoT Central 會自動建立模擬裝置。 模擬裝置可讓您在連線實際裝置之前，先測試您應用程式的行為。

下列小節描述 [裝置範本]  頁面上的每個索引標籤。

## <a name="measurements"></a>量測

量測是來自裝置的資料。 您可以在裝置範本中新增多個量測，以符合裝置的功能。

- **遙測**量測是您裝置隨著時間收集的資料點。 這些資料點會以連續資料流的形式呈現。 例如，溫度。
- **事件**量測是時間點資料，代表裝置上某個重要的事物。 嚴重性層級代表事件的重要性。 例如，風扇馬達錯誤。
- **狀態**量測代表裝置或其元件在一段時間內的狀態。 例如，風扇模式可定義為具有 [運轉中]  和 [已停止]  這兩種可能的狀態。
- **位置**度量是經過一段時間中的裝置的經度和緯度座標。 例如，風扇可以從一個位置移動，至另一個。

### <a name="create-a-telemetry-measurement"></a>建立遙測量測

若要新增新的遙測度量，請選取 **+ 新測量**，選擇**遙測**測量為輸入，然後在表單上輸入詳細資料。

> [!NOTE]
> 裝置範本中的欄位名稱必須符合對應裝置程式碼中的屬性名稱，才能在實際的裝置連線時，讓遙測量測顯示在應用程式中。 隨著您繼續在後續幾節定義裝置範本，以設定各項設定、裝置屬性和命令時，請採取相同的做法。
.png 比方說，您可以在其中新增新的溫度遙測度量：

| 顯示名稱        | 欄位名稱    |  Units    | Min   |max|
| --------------------| ------------- |-----------|-------|---|
| 溫度         | temp          |  degC     |  0    |100|

![含溫度量測詳細資料的 [建立遙測] 表單](./media/howto-set-up-template/measurementsform.png)

選取 [儲存]  之後，[溫度]  量測就會出現在量測清單中。 一小段時間之後，您會看到來自模擬裝置的溫度資料視覺效果。

當顯示遙測，您可以選擇下列彙總選項：平均值、 最小值、 最大值、 Sum 和 Count。 **平均**當做圖表上的預設彙總。

> [!NOTE]
> 遙測量測的資料類型為浮點數。

### <a name="create-an-event-measurement"></a>建立事件量測

若要新增新的事件度量，請選取 **+ 新測量**，然後選取**事件**做為度量單位類型。 在 [建立事件]  表單上輸入詳細資料。

提供事件的 [顯示名稱]  、[欄位名稱]  及 [嚴重性]  。 您可以從三個可用的嚴重性層級選擇：[錯誤]  、[警告]  和 [資訊]  。

例如，您可以新增 [風扇馬達錯誤]  事件。

| 顯示名稱        | 欄位名稱    |  預設嚴重性 |
| --------------------| ------------- |-----------|
| 風扇馬達錯誤     | fanmotorerror |  Error    |

![含風扇馬達事件詳細資料的 [建立事件] 表單](./media/howto-set-up-template/eventmeasurementsform.png)

選取 [儲存]  之後，[風扇馬達錯誤]  量測就會出現在量測清單中。 一小段時間之後，您會看到來自模擬裝置的事件資料視覺效果。

若要檢視更多詳細的事件，請選取圖表上的 [事件] 圖示：

![[風扇馬達錯誤] 事件的詳細資料](./media/howto-set-up-template/eventmeasurementsdetail.png)

> [!NOTE]
> 事件度量的資料類型為字串。

### <a name="create-a-state-measurement"></a>建立狀態量測

若要新增新的狀態度量單位，請選取 **+ 新測量**按鈕，然後選取**狀態**做為度量單位類型。 在 [建立狀態]  表單上輸入詳細資料。

提供狀態之 [顯示名稱]  、[欄位名稱]  及 [值]  的詳細資料。 每個值也可以有顯示名稱，當值顯示在圖表和資料表上時，便會使用該顯示名稱。

例如，您可以新增 [風扇模式]  狀態，使其包含兩個可由裝置傳送的可能值，分別是 [運轉中]  和 [已停止]  。

| 顯示名稱 | 欄位名稱    |  值 1   | 顯示名稱 | 值 2    |顯示名稱  | 
| -------------| ------------- |----------- | -------------| -----------| -------------|
| 風扇模式     | fanmode       |  1         | 運作中    |     0      | 已停止      |

![含風扇模式詳細資料的 [編輯狀態] 表單](./media/howto-set-up-template/statemeasurementsform.png)

選取 [儲存]  之後，[風扇模式]  狀態量測就會出現在量測清單中。 一小段時間之後，您會看到來自模擬裝置的狀態資料視覺效果。

如果裝置短時間內傳送太多資料點，狀態度量會以其他視覺效果顯示。 選取圖表，來檢視依時間先後順序的時間週期內的所有資料點。 您也可以縮小時間範圍，以查看圖表上所繪製的量測。

> [!NOTE]
> 狀態度量的資料類型為字串。

### <a name="create-a-location-measurement"></a>建立位置的度量

若要新增新的位置測量，請選取 **+ 新測量**，選擇**位置**測量為輸入，然後在 輸入詳細資料**建立度量**表單。

例如，您可以加入新的位置遙測度量：

| 顯示名稱        | 欄位名稱    |
| --------------------| ------------- |
| 資產位置      |  assetloc     |

![「 建立位置 」 位置度量的詳細資料表單](./media/howto-set-up-template/locationmeasurementsform.png)

選取後**儲存**，則**位置**測量會顯示在度量清單中。 在一段時間，您會看到模擬裝置的位置資料的視覺效果。

當顯示的位置，您可以選擇下列選項： 最新的位置與位置歷程記錄。 **位置記錄**則只會套用在所選的時間範圍內。

位置測量的資料類型是物件，包含經度、 緯度，以及選擇性的高度。 下列程式碼片段顯示 JavaScript 結構：

```javascript
assetloc: {
  lon: floating point number,
  lat: floating point number,
  alt?: floating point number
}
```

## <a name="settings"></a>設定

設定可控制裝置。 它們可讓操作員對裝置提供輸入。 您可以在裝置範本中新增多個設定，這些設定會在 [設定]  索引標籤上顯示為圖格供操作員使用。 您可以將許多類型的設定： 數字、 文字、 日期、 切換和 [區段] 標籤。

設定的狀態可為三者其中之一。 裝置會回報下列狀態。

- **已同步處理**：裝置已變更來反映設定值。

- **Pending**：裝置目前正在變更為設定值。

- **錯誤**：裝置傳回錯誤。

比方說，您可以新增風扇速度設定，方法是選取**設定**並輸入新**數目**設定：

| 顯示名稱  | 欄位名稱    |  Units  | 小數位數 |Initial|
| --------------| ------------- |---------| ---------|---- |
| 風扇速度     | fanSpeed      | RPM     | 2        | 0   |

![含速度設定詳細資料的 [設定數字] 表單](./media/howto-set-up-template/settingsform.png)

選取 [儲存]  之後，[風扇速度]  設定會顯示為圖格。 操作員可以使用 [Device Explorer]  頁面上的設定來變更裝置的風扇速度。

## <a name="properties"></a>屬性

屬性是固定的裝置位置和序號等裝置與相關聯的中繼資料。 在裝置範本中新增多個屬性之後，這些屬性會在 [屬性]  索引標籤上顯示為圖格。屬性具有類型，例如數字、 文字、 日期、 切換、 裝置屬性、 標籤或固定的位置。 當他們建立的裝置，以及他們可以隨時編輯這些值，運算子會指定屬性的值。 裝置屬性是唯讀的，而且會從裝置傳送至應用程式。 操作員無法變更裝置的內容。 當實際的裝置連線時，[裝置屬性] 圖格會更新應用程式中。

屬性分為兩種類別：

- 「裝置屬性」  ，裝置會向 IoT Central 應用程式報告這些屬性。 裝置屬性是由裝置報告的唯讀值，並且會在實際裝置連線時，在應用程式中更新。
- 「應用程式屬性」  ，這些屬性儲存在應用程式中，並可供操作員編輯。 應用程式屬性只會儲存在應用程式，而且從未見過的裝置。

比方說，您可以在 [屬性]  索引標籤上，將裝置上次維修的日期新增為 [日期]  屬性 (應用程式屬性)：

| 顯示名稱  | 欄位名稱 | 初始值   |
| --------------| -----------|-----------------|
| 上次維修日期      | lastServiced        | 2019/01/29     |

![[屬性] 索引標籤上的設定 [上次維修]](./media/howto-set-up-template/propertiesform.png)

選取 [儲存]  之後，裝置的上次維修日期會顯示為圖格。

建立圖格之後，您可以在 [Device Explorer]  中變更應用程式屬性值。

### <a name="create-a-location-property"></a>建立位置的屬性

您可以將地理內容提供給您 Azure IoT Central 的位置資料，並對應任何緯度和經度座標或街道地址。 「Azure 地圖服務」會在 IoT Central 中啟用這項功能。

您可以新增兩種類型的位置屬性：

- **位置作為應用程式屬性** (此屬性儲存在應用程式中)。 應用程式屬性只會儲存在應用程式，而且從未見過的裝置。
- **將位置新增為裝置屬性**：裝置會向應用程式回報此屬性。 這種類型的屬性最適用於靜態的位置。

> [!NOTE]
> 做為屬性的位置就不會記錄歷程記錄。 如果想要使用歷程記錄，請使用位置度量。

#### <a name="add-location-as-an-application-property"></a>將位置新增為應用程式屬性

您可以在 IoT Central 應用程式中使用「Azure 地圖服務」來建立位置屬性作為應用程式屬性。 例如，您可以新增裝置安裝地址：

1. 瀏覽至 [屬性]  索引標籤。

2. 在資源庫中，選取 [位置]  。

3. 設定位置的 [顯示名稱]  、[欄位名稱]  及 (選擇性) [初始值]  。

    | 顯示名稱  | 欄位名稱 | 初始值 |
    | --------------| -----------|---------|
    | 安裝地址 | installAddress | Microsoft, 1 Microsoft Way, Redmond, WA 98052   |

   ![含位置詳細資料的 [設定位置] 表單](./media/howto-set-up-template/locationcloudproperty2.png)

   新增位置有兩種支援的格式：
   - **以地址新增位置**
   - **以座標新增位置**

4. 選取 [儲存]  。 操作員可以在 [Device Explorer]  中更新位置值。

#### <a name="add-location-as-a-device-property"></a>將位置新增為裝置屬性

您可以將位置屬性建立成裝置會回報的裝置屬性。 例如，如果您想要追蹤裝置位置：

1. 瀏覽至 [屬性]  索引標籤。

2. 從資源庫中選取 [裝置屬性]  。

3. 設定顯示名稱和欄位名稱，然後選取 [位置]  作為資料類型：

    | 顯示名稱  | 欄位名稱 | 資料類型 |
    | --------------| -----------|-----------|
    | 裝置位置 | deviceLocation | location  |

   > [!NOTE]
   > 欄位名稱必須符合對應裝置程式碼中的屬性名稱

   ![含位置詳細資料的 [設定裝置屬性] 表單](./media/howto-set-up-template/locationdeviceproperty2.png)

實際的裝置連接之後，位置您新增的裝置屬性更新的裝置所傳送的值。 您已將 location 屬性之後，您可以[新增至裝置儀表板中的位置以視覺化方式檢視地圖](#add-a-location-in-the-dashboard)。

## <a name="commands"></a>命令

命令可用來從遠端管理裝置。 它們可讓操作員在裝置上執行命令。 您可以在裝置範本中新增多個命令，這些命令會在 [命令]  索引標籤上顯示為圖格，以供操作員使用。 身為裝置建置者，您可以有彈性地根據需求定義命令。

命令與設定有何不同？

* **設定**：設定是您想要套用至裝置的組態。 您想要裝置維持該組態直到您變更它。 例如，您想要設定冰箱的溫度，並且希望即使冰箱重新啟動也保有該設定。

* **命令**：您會使用命令從 IoT Central 自遠端在裝置上立即執行命令。 如果裝置未連線，命令就會逾時並失敗。 例如，您想要重新啟動某個裝置。

比方說，您可以加入新**Echo**藉由選取命令**命令** 索引標籤，然後選取 **+ 新增 命令**，並輸入新的命令詳細資料：

| 顯示名稱  | 欄位名稱 | 預設逾時 | 資料類型 |
| --------------| -----------|---------------- | --------- |
| 回應命令  | 回應       |  30             | text      |

![含回應詳細資料的 [設定命令] 表單](./media/howto-set-up-template/commandsecho1.png)

選取 [儲存]  之後，**回應**命令會顯示為圖格，當您的實際裝置連線時，就能從 [Device Explorer]  使用它。 您的命令的欄位名稱必須符合對應的裝置程式碼，以便能順利執行的命令中的屬性名稱。

## <a name="rules"></a>規則

規則可讓操作員近乎即時地監視裝置。 規則會在觸發規則時自動叫用動作，例如傳送電子郵件。 目前有一種類型的規則可供使用：

- **遙測規則**：當所選裝置的遙測超出指定閾值時，便會觸發此規則。 [深入了解遙測規則](howto-create-telemetry-rules.md)。

## <a name="dashboard"></a>儀表板

儀表板是操作員前往查看裝置的相關資訊。 產生器中，為您加入圖格此頁，以協助您了解裝置其運作方式的運算子。 您可以新增許多種儀表板圖格，如影像、折線圖、橫條圖、關鍵效能指標 (KPI)、設定和屬性，以及標籤。

例如，您可以從資源庫中選取 [儀表板]  ，然後選取 [設定及屬性]  圖格來新增該圖格，以顯示目前選取的設定和屬性值：

![含設定和屬性詳細資料的 [設定裝置詳細資料] 表單](./media/howto-set-up-template/dashboardsettingsandpropertiesform1.png)

現在當操作員在 [Device Explorer]  中檢視儀表板時，他們可以看到該圖格。

### <a name="add-a-location-in-the-dashboard"></a>將位置新增儀表板

如果您設定位置度量時，您可以在裝置儀表板中視覺化地圖與位置。

1. 瀏覽至 [儀表板]  索引標籤。

1. 在 [裝置儀表板] 上，從資源庫中選取 [地圖]  。

1. 提供地圖的標題。 下列範例具有標題**裝置的目前位置**。 然後選擇您先前設定的位置測量**測量** 索引標籤。在下列範例中，**資產位置**選取度量：

   ![含標題和屬性詳細資料的 [設定地圖] 表單](./media/howto-set-up-template/locationcloudproperty5map.png)

1. 選取 [儲存]  。 地圖圖格現在會顯示您選取的位置。

您可以調整地圖底圖。 當運算子檢視的儀表板**Device Explorer**，所有儀表板圖格，您已設定，包括位置地圖會顯示。

若要深入了解如何使用 Azure IoT Central 中的磚，請參閱[使用儀表板磚](howto-use-tiles.md)。

## <a name="next-steps"></a>後續步驟

了解如何在 Azure IoT Central 應用程式中設定裝置範本之後，現在就可以：

> [!div class="nextstepaction"]
> [建立新的裝置範本版本](howto-version-device-template.md)
> [MXChip IoT DevKit 裝置連接至 Azure IoT Central 應用程式](howto-connect-devkit.md)
> [一般用戶端應用程式連接到您的 AzureIoT Central 應用程式 (Node.js)](howto-connect-nodejs.md)