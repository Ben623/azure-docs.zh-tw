---
title: 經常性存取、 非經常性存取和封存 blob-Azure 儲存體的存取層
description: 經常性存取、 非經常性存取和封存存取層，Azure 儲存體帳戶。
services: storage
author: mhopkins-msft
ms.service: storage
ms.topic: conceptual
ms.date: 03/23/2019
ms.author: mhopkins
ms.reviewer: clausjor
ms.subservice: blobs
ms.openlocfilehash: 8e9e27f14c4ccd6f5822033baa21aaafcf96c428
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/13/2019
ms.locfileid: "65148502"
---
# <a name="azure-blob-storage-hot-cool-and-archive-access-tiers"></a>Azure Blob 儲存體︰ 經常性存取、 非經常性存取和封存存取層

Azure 儲存體提供不同的存取層，可讓您以最符合成本效益的方式儲存 blob 物件資料。 可用的存取層級包括：

- **熱**-最佳化來儲存經常存取的資料。
- **非經常性存取**-用於儲存不常存取且儲存在至少 30 天的資料而最佳化。
- **封存**-用於儲存很少存取且儲存至少 180 天具有彈性延遲需求 （大約數小時） 的資料而最佳化。

下列考量適用於不同的存取層級：

- 只有在 blob 層級，而不是在儲存體帳戶層級使用封存存取層。
- 非經常性存取層中的資料可容忍稍微較低的可用性，但仍要求高持久性以及與經常性存取資料類似的存取時間和輸送量特性。 對於非經常性存取資料，稍微較低的可用性服務等級協定 (SLA) 和更高的存取相較於經常性存取資料的成本會是可接受的取捨較低的儲存體成本。
- 封存儲存體已離線並提供最低的儲存成本，但存取成本最高。
- 只有經常性和非經常性存取層可以設定帳戶層級。
- 經常性存取、 非經常性與封存層可以設定在物件層級。

儲存在雲端的資料迅速成長。 若要為不斷擴充的儲存體需求來管理成本，根據存取頻率和計劃性保留期來組織您的資料，進而將成本最佳化很有幫助。 在雲端中儲存的資料可以不同方式它已產生、 處理和存留期內存取。 有些資料在其存留期內會積極地存取及修改。 有些資料在其存留期的早期存取頻率很高，但存取頻率隨著資料老化而大幅下滑。 某些資料在雲端中維持閒置，而且很少，如果存取之後儲存。

每個資料存取案例受惠於針對特定存取模式最佳化的不同存取層。 使用經常性存取、 各種價格模式，具有不同的存取層的這項需求的非經常性與封存存取層，Azure Blob 儲存體位址。

## <a name="storage-accounts-that-support-tiering"></a>支援階層處理的儲存體帳戶

您可能只層經常性存取、 非經常性存取，將物件儲存體資料，或保存在 Blob 儲存體和一般用途 v2 (GPv2) 帳戶。 一般用途 v1 (GPv1) 帳戶不支援階層處理。 不過，您可以輕鬆地將現有的 GPv1 或 Blob 儲存體帳戶轉換為 GPv2 帳戶，透過 Azure 入口網站中的單鍵程序中。 GPv2 提供 blob、 檔案和佇列和各種其他新的儲存體功能的存取權的新的定價結構。 接下來，將只在 GPv2 帳戶中提供一些新功能與降價剪。 因此，您應該評估使用 GPv2 帳戶，但只使用它們之後檢閱所有服務的定價。 某些工作負載可以會更高成本在 GPv2 上比在 GPv1。 如需詳細資訊，請參閱 [Azure 儲存體帳戶概觀](../common/storage-account-overview.md)。

Blob 儲存體和 GPv2 帳戶會公開**存取層**在帳戶層級的屬性。 這個屬性可讓您指定的預設存取層與經常性存取或非經常性存取儲存體帳戶沒有在物件層級設定明確階層中任何 blob。 對於已在物件層級設定儲存層的物件，不會套用此帳戶層。 封存層可以只在物件層級套用。 您可以隨時在這些存取層之間切換。

## <a name="premium-performance-block-blob-storage"></a>Premium 效能區塊 blob 儲存體

Premium 效能區塊 blob 儲存體可讓您可透過高效能硬體經常存取的資料。 此效能層級中的資料會儲存在固態硬碟 (Ssd)，這針對低且一致的延遲進行最佳化。 Ssd 提供更高的交易速率和相較於傳統的硬碟機的輸送量。

Premium 效能區塊 blob 儲存體適合需要快速且一致的回應時間的工作負載。 它是最適合執行許多小型交易的詳細資訊，例如擷取遙測資料、 訊息和資料轉換的工作負載。 牽涉到使用者項目，例如互動式視訊編輯、 靜態 web 內容，以及線上交易的資料也是很好的候選項目。

Premium 效能區塊 blob 儲存體只能透過區塊 blob 儲存體帳戶類型，且目前不支援經常性存取、 非經常性存取或封存存取層級階層處理。

## <a name="hot-access-tier"></a>經常性存取層

經常性存取層會有儲存體成本高於非經常性存取和封存層，但存取成本最低。 經常性存取層的使用案例範例包括：

- 正在使用中或預期會經常存取 （讀取和寫入） 的資料。
- 資料會預備好進行處理且最終移轉至非經常性存取層。

## <a name="cool-access-tier"></a>非經常性存取層

非經常性存取層具有較低的儲存體成本和相較於經常性存取儲存體的存取成本較高。 這一層適用於將保留在非經常性存取層至少 30 天的資料。 非經常性存取層的使用案例範例包括：

- 短期備份和災害復原資料集。
- 不再經常檢視，但存取時應立即可用的較舊媒體內容。
- 當收集較多資料以供未來處理時，需要以符合成本效益方式預存的大型資料集。 (例如  ，科學資料、來自製造工廠的原始遙測資料等長期儲存)

## <a name="archive-access-tier"></a>封存存取層

封存存取層具有最低的儲存體成本和資料擷取成本比較高相較於經常性存取與非經常性存取層。 這一層適用於可承受擷取延遲數個小時，而且將保留在封存層中至少 180 天的資料。

當 blob 位於封存儲存體時，blob 資料已離線，而且無法讀取、 複製、 覆寫，或修改。 封存儲存體中，您無法取得 blob 的快照集。 不過，Blob 中繼資料會保持連線且可以取得，讓您可列出 Blob 和其屬性。 在封存中的 blob，唯一有效的作業是 GetBlobProperties、 GetBlobMetadata、 ListBlobs、 SetBlobTier 和 DeleteBlob。

封存存取層的使用案例範例包括：

- 長期備份、次要備份和封存資料集
- 即使已處理成最終可用格式，但還是需要保存的原始資料。 (例如  ，轉碼成其他格式之後的原始媒體檔案)
- 需要儲存一段時間且幾乎不曾存取的相容性和封存資料。 (*例如*，保全攝影機錄影畫面、 醫療機構舊 X 光 /mri、 錄音和文字記錄的客戶電話適用於金融服務)

### <a name="blob-rehydration"></a>Blob 解除凍結

若要閱讀封存儲存體中的資料，您必須先將 blob 層變更為經常性存取或非經常性存取。 此程序稱為解除凍結，最多可能需要 15 小時才能完成。 為了達到最佳效能，建議使用大型 Blob。 同時解除凍結數個小型 blob 可能會增加額外時間。

在解除凍結期間，您可以查看 [封存狀態]  blob 屬性，以確認是儲存層否已變更。 視目的地層而定，狀態會顯示為 "rehydrate-pending-to-hot" 或 "rehydrate-pending-to-cool"。 完成時，系統會移除封存狀態屬性，而 [存取層]  blob 屬性會反映新的經常性存取或非經常性存取層。  

## <a name="blob-level-tiering"></a>Blob 層級的階層處理

Blob 層級的階層處理可讓您使用稱為[設定 Blob 層](/rest/api/storageservices/set-blob-tier)的單一作業，在物件層級變更您的資料層。 您可以隨著使用模式變更，在經常性存取、非經常性存取或封存層之間輕鬆地變更 blob 的存取層，而不必在帳戶之間移動資料。 所有的存取層變更都會立即發生。 但是，從封存解除凍結 Blob 可能需要數小時的時間。

最後一個 blob 層變更的時間會透過 [存取層變更時間]  blob 屬性公開。 如果 blob 位於封存層中，它無法覆寫，因此在此案例中不允許上傳相同的 blob。 您可以覆寫中的經常性存取或非經常性存取層，大小寫新的 blob 會繼承自已覆寫的 blob 層的 blob。

所有的三個存取層中的 blob 可以共存於相同的帳戶。 若 blob 未明確指派任何階層，則系統會從帳戶存取層的設定加以推斷。 如果存取層是從帳戶推斷而來，您會看到 [推斷的存取層]  blob 屬性設定為 "true"，而且 blob [存取層]  blob 屬性符合帳戶層。 在 Azure 入口網站中，推斷屬性會顯示 blob 存取層的存取層 (例如**經常性存取 （推斷）** 或是**非經常性存取 （推斷）** )。

> [!NOTE]
> 封存儲存體與 Blob 層級階層處理只支援區塊 blob。 您也無法變更具有快照集之區塊 blob 的存取層。

> [!NOTE]
> 區塊 blob 儲存體帳戶中儲存的資料目前無法經常性存取、 非經常性存取或封存使用分層[設定 Blob 層](/rest/api/storageservices/set-blob-tier)或使用 Azure Blob 儲存體生命週期管理。
> 若要移動資料，您必須以同步方式複製 blob 的區塊 blob 儲存體帳戶中不同的帳戶，使用經常性存取層[放置區塊從 URL API](/rest/api/storageservices/put-block-from-url)或版本的 AzCopy 支援此 API。
> *Put Block From URL* API 會同步複製伺服器上的資料，這表示只有將所有資料從原始伺服器位置移動到目標位置後，才會完成呼叫。

### <a name="blob-lifecycle-management"></a>Blob 生命週期管理

Blob 儲存體生命週期管理提供了豐富、 以規則為基礎的原則，您可以使用轉換您的資料，最佳的存取層，並讓其生命週期結尾的資料過期。 若要深入了解，請參閱[管理 Azure Blob 儲存體生命週期](storage-lifecycle-management-concepts.md)。  

### <a name="blob-level-tiering-billing"></a>Blob 層級的階層處理計費

當 Blob 移至存取頻率較低的階層 (經常性存取 -> 非經常性存取、經常性存取 -> 封存，或非經常性存取 -> 封存) 時，此作業會在寫入目的地階層時計費，且適用目的地階層的寫入作業 (每 10,000 個) 和資料寫入 (每 GB) 費用。

當 blob 移至存取頻率較高的階層 （封存-> 非經常性存取、 封存-> 經常性存取，或非經常性存取-> 經常性存取），作業會從來源階層，適用的讀取的作業 （每 10,000 個） 和資料擷取 （每 GB) 費用，來源階層讀取時計費。 下表摘要說明層級變更的計費方式：

| | **寫入費用 (作業 + 存取)** | **讀取費用 (作業 + 存取)**
| ---- | ----- | ----- |
| **SetBlobTier 方向** | 經常性存取-> 非經常性存取、 經常性存取-> 封存，非經常性存取-> 封存 | 封存-> 非經常性存取、 封存-> 經常性存取、 非經常性存取-> 經常性存取

如果帳戶層從經常性存取切換至非經常性存取，您需針對在 GPv2 帳戶中未設定存取層的所有 blob 支付寫入作業費用 (每 10,000 個)。 此變更在 Blob 儲存體帳戶中不收費。 如果您將 Blob 儲存體或 GPv2 帳戶從非經常性存取切換至經常性存取，您需支付讀取作業 (每 10,000 個) 和資料擷取 (每 GB) 費用。 可能也適用任何移出非經常性存取或封存層之 blob 的提早刪除費用。

### <a name="cool-and-archive-early-deletion"></a>非經常性存取和封存提前刪除

除了每 GB、每月費用，任何移入非經常性存取層 (僅限 GPv2 帳戶) 的 blob 都受制於 30 天的非經常性存取提早刪除期間，而且任何移入封存層的 blob 都受制於 180 天的封存提早刪除期間。 此費用按比例計算。 例如，如果 blob 移至封存，然後在 45 天後遭到刪除或移至經常倖存取層，您需支付相當於在封存中儲存該 blob 135 (180 減去 45) 天的提早刪除費用。

如果沒有存取層變更，您可以使用 Blob 屬性 **creation-time** 來計算提前刪除。 否則您可以使用時的存取層，非經常性存取或封存上次修改檢視 blob 屬性：**存取層變更為時間**。 如需 Blob 屬性的詳細資訊，請參閱[取得 Blob 屬性](https://docs.microsoft.com/rest/api/storageservices/get-blob-properties)。

## <a name="comparing-block-blob-storage-options"></a>比較區塊 blob 儲存體選項

下表所示的進階效能區塊 blob 儲存體，並且為作用比較、 非經常性與封存存取層。

|                                           | **Premium 效能** | **經常性存取層** | **非經常性存取層** | **封存層**
| ----------------------------------------- | ---------------- | ------------ | ----- | ----- |
| **可用性**                          | 99.9%            | 99.9%        | 99% | N/A |
| **可用性** <br> **(RA-GRS 讀取)**  | N/A              | 99.99%       | 99.9% | N/A |
| **使用費用**                         | 較高的儲存體成本、 較低的存取和交易成本 | 儲存成本較高，存取和交易成本較低 | 儲存成本較低，存取和交易成本較高 | 儲存成本最低，存取和交易成本最高 |
| **最小物件大小**                   | N/A | N/A | N/A | N/A |
| **最小儲存持續時間**              | N/A | N/A | 30 天 (僅限 GPv2) | 180 天
| **延遲** <br> **(距第一位元組時間)** | 單一位數 （毫秒) | 毫秒 | 毫秒 | < 15 小時

> [!NOTE]
> 延展性和效能目標，請參閱[儲存體帳戶的 Azure 儲存體延展性和效能目標](../common/storage-scalability-targets.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)

## <a name="quickstart-scenarios"></a>快速入門案例

在這一節中，我們會使用 Azure 入口網站示範下列案例︰

- 如何變更 GPv2 或 Blob 儲存體帳戶的預設帳戶存取層。
- 如何在 GPv2 或 Blob 儲存體帳戶中變更 Blob 的存取層。

### <a name="change-the-default-account-access-tier-of-a-gpv2-or-blob-storage-account"></a>變更 GPv2 或 Blob 儲存體帳戶的預設帳戶存取層

1. 登入 [Azure 入口網站](https://portal.azure.com)。

1. 瀏覽至儲存體帳戶、選取 [所有資源]，然後選取您的儲存體帳戶。

1. 在 [設定] 刀鋒視窗中按一下 [組態]  ，以檢視和/或變更帳戶組態。

1. 選取正確的存取層，為您的需求：將 [存取層]  設定為 [非經常性存取]  或 [經常性存取]  。

1. 按一下刀鋒視窗頂端的 [儲存]  。

### <a name="change-the-tier-of-a-blob-in-a-gpv2-or-blob-storage-account"></a>變更 GPv2 或 Blob 儲存體帳戶中的 blob 層

1. 登入 [Azure 入口網站](https://portal.azure.com)。

1. 若要瀏覽至您的 blob 儲存體帳戶中，選取**的所有資源**，選取儲存體帳戶中，選取您的容器，然後選取 您的 blob。

1. 在  **Blob 屬性**刀鋒視窗中，選取**存取層**下拉式功能表，選取**經常性存取層**，**酷炫**，或**封存**存取層。

1. 按一下刀鋒視窗頂端的 [儲存]  。

## <a name="pricing-and-billing"></a>價格和計費

所有儲存體帳戶會對以每個 Blob 層為基礎的 Blob 儲存體使用價格模型。 請注意下列計費考量：

- **儲存成本**：除了儲存的資料量，儲存資料的成本會根據存取層而有所不同。 每 GB 的成本會隨著儲存層存取頻率降低而減少。
- **資料存取成本**：資料存取費用會隨著儲存層存取頻率降低而增加。 對於非經常性與封存存取層中的資料，向您收取讀取的每 gb 資料存取費用。
- **交易成本**：所有層都有每筆交易的費用，該費用會隨著儲存層存取頻率降低而增加。
- **異地複寫資料傳輸成本**：此費用適用於已設定異地複寫的帳戶，包括 GRS 和 RA-GRS。 異地複寫資料傳輸會產生每 GB 費用。
- **輸出資料傳輸成本**：輸出資料傳輸 (從 Azure 區域傳出的資料) 會產生每 GB 頻寬使用量費用，與一般用途的儲存體帳戶一致。
- **變更存取層**:從非經常性存取層為經常性存取變更的帳戶存取層時，會產生等於讀取儲存體帳戶中的所有資料的費用。 不過，將帳戶存取層從經常性存取層變更為非經常性存取層，會產生相當於將所有資料寫入非經常性存取層的費用 (僅限 GPv2 帳戶)。

> [!NOTE]
> 如需 Blob 儲存體帳戶的定價詳細資訊，請參閱 [Azure 儲存體定價](https://azure.microsoft.com/pricing/details/storage/)頁面。 如需輸出資料傳輸費用的詳細資訊，請參閱[資料傳輸定價詳細資料](https://azure.microsoft.com/pricing/details/data-transfers/)頁面。

## <a name="faq"></a>常見問題集

**如果我想要將我的資料進行階層處理，應使用 Blob 儲存體或 GPv2 帳戶？**

建議您 GPv2，而不要使用 Blob 儲存體帳戶進行階層處理。 GPv2 支援 Blob 儲存體帳戶支援的所有功能，以及其他許多功能。 Blob 儲存體與 GPv2 之間的價格幾乎相同，但是 GPv2 帳戶將提供一些新功能和降價。 GPv1 帳戶不支援階層處理。

GPv1 與 GPv2 帳戶之間的價格結構不同，客戶在決定使用 GPv2 帳戶之前，應該仔細評估兩者。 您可以透過簡單的單鍵程序，輕鬆地將現有的 Blob 儲存體或 GPv1 帳戶轉換為 GPv2。 如需詳細資訊，請參閱 [Azure 儲存體帳戶概觀](../common/storage-account-overview.md)。

**可以儲存物件中的三個 （經常性存取、 非經常性存取和封存） 存取相同帳戶中的層級嗎？**

是。 設定於帳戶層級的 [存取層]  屬性是套用至該帳戶中所有物件的預設層 (沒有明確設定的層)。 不過，blob 層級的階層處理功能可讓您在物件層級上設定存取層，而不管帳戶上設定的存取層為何。 中的 blob 都是三個存取層 （經常性存取、 非經常性存取或封存） 可能會存在於相同的帳戶。

**我可以變更 GPv2 或 Blob 儲存體帳戶的預設存取層？**

是，您可以變更設定的預設存取層**存取層**儲存體帳戶上的屬性。 變更存取層適用於所有物件儲存在帳戶中沒有設定明確層。 存取層從經常性存取切換至非經常性存取時，會產生寫入作業 （每 10,000 個） 的所有 blob，而不需要在僅限 GPv2 帳戶中設定的層從非經常性存取層為經常性存取時，會產生讀取的作業 （每 10,000 個） 和資料擷取 （每 GB) 費用的 Blob 儲存體中的所有 blob和 GPv2 帳戶。

**是否可以將我的預設帳戶存取層設定為封存？**

沒有。 只有經常性和非經常性存取層可能會設定為預設帳戶存取層。 封存只能設定於物件層級。

**所在區域是經常性、 非經常性存取和封存存取層中可用？**

經常性和非經常性存取層以及 blob 等級的階層處理可用於所有區域。 封存儲存體一開始只在精選區域中提供。 如需完整清單，請參閱 [Azure 依區域提供的產品](https://azure.microsoft.com/regions/services/)。

**非經常性存取層中的 blob 行為與經常性存取層中的不同？**

經常性存取層中的 blob 有相同的延遲，為 blob，GPv1、 GPv2 和 Blob 儲存體帳戶中。 非經常性存取層中的 blob 有類似的延遲 （以毫秒為單位） 為 blob GPv1、 GPv2 和 Blob 儲存體帳戶中。 封存存取層中的 blob 會有好幾個小時的延遲，GPv1、 GPv2 和 Blob 儲存體帳戶中。

非經常性存取層中的 blob 有稍微較低的可用性服務等級 (SLA) 於經常性存取層中儲存的 blob。 如需詳細資訊，請參閱[儲存體 SLA](https://azure.microsoft.com/support/legal/sla/storage/v1_2/)。

**經常性存取、非經常性存取和封存層之間的作業是否相同？**

是。 經常性存取與非經常性存取之間的所有作業都完全一致。 經常性存取與非經常性存取的所有有效封存作業 (包括刪除、列出、取得 blob 屬性/中繼資料，以及設定 blob 層) 都完全一致。 無法讀取或修改封存層中的 blob。

**將 Blob 從封存層解凍至經常性存取或非經常性存取層時，我要如何知道解除凍結已完成？**

在解除凍結期間，您可以使用「取得 blob 屬性」作業來輪詢 [封存狀態]  屬性，以確認存取層變更何時完成。 視目的地層而定，狀態會顯示為 "rehydrate-pending-to-hot" 或 "rehydrate-pending-to-cool"。 完成時，系統會移除封存狀態屬性，而 [存取層]  blob 屬性會反映新的經常性存取或非經常性存取層。  

**設定 blob 的存取層之後，何時會開始以適當的費率計費？**

每個 Blob 一律根據 Blob [存取層]  屬性所指定的存取層計費。 當您為為 Blob 設定新存取層時，[存取層]  屬性會立即反映所有轉換的新存取層。 不過，將封存層的 Blob 解除凍結至經常性存取或非經常性存取層可能需要數小時的時間。 在此情況下，您會以封存費率計費，直到解除凍結完成為止，[存取層]  屬性會反映新的存取層。 屆時，您會以經常性存取或非經常性存取費率，為該 Blob 付費。

**如何判斷在刪除 blob 或將它移出非經常性存取或封存層時，我是否需支付提早刪除費用？**

在 30 天前和 180 天前遭到刪除或移出非經常性存取 (僅限 GPv2 帳戶) 或封存層的任何 Blob，分別會產生按比例計算的提早刪除費用。 檢查 [存取層變更時間]  Blob 屬性 (該屬性提供最後一次存取層變更的戳記)，即可判斷 Blob 放在非經常性存取或封存層中的時間長度。 如需詳細資訊，請參閱 <<c0> [ 非經常性存取和封存提前刪除](#cool-and-archive-early-deletion)。

**哪些 Azure 工具和 SDK 支援 blob 層級的階層處理和封存儲存體？**

Azure 入口網站、PowerShell 和 CLI 工具，以及 .NET、Java、Python 和 Node.js 用戶端程式庫全都支援 blob 層級的階層處理和封存儲存體。  

**我可以在經常性存取、非經常性存取和封存層中儲存多少資料？**

在帳戶層級，而不是依照存取層，會設定資料儲存體，以及其他限制。 因此，您可以選擇在其中一層或在全部三個層中使用所有限制。 如需詳細資訊，請參閱 [Azure 儲存體延展性和效能目標](../common/storage-scalability-targets.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)。

## <a name="next-steps"></a>後續步驟

### <a name="evaluate-hot-cool-and-archive-in-gpv2-blob-storage-accounts"></a>在 GPv2 Blob 儲存體帳戶中評估經常性存取、非經常性存取和封存

[依照區域檢查經常性存取、非經常性存取和封存的可用性](https://azure.microsoft.com/regions/#services)

[管理 Azure Blob 儲存體生命週期](storage-lifecycle-management-concepts.md)

[啟用 Azure 儲存體計量以評估您目前的儲存體帳戶使用量](../common/storage-enable-and-view-metrics.md)

[依照區域檢查 Blob 儲存體和 GPv2 帳戶中的經常性存取、非經常性存取和封存價格](https://azure.microsoft.com/pricing/details/storage/)

[檢查資料傳輸價格](https://azure.microsoft.com/pricing/details/data-transfers/)
