---
title: Azure Migrate 中的評量
description: 深入瞭解 Azure Migrate 中的評量。
ms.topic: conceptual
ms.date: 02/17/2020
ms.openlocfilehash: 0cf933dd1c8c61edfcea20ea954c5813f3848b28
ms.sourcegitcommit: b8f2fee3b93436c44f021dff7abe28921da72a6d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/18/2020
ms.locfileid: "77425692"
---
# <a name="about-assessments-in-azure-migrate"></a>關於 Azure Migrate 中的評量

本文說明如何在[Azure Migrate：伺服器評估](migrate-services-overview.md#azure-migrate-server-assessment-tool)中計算評量。 您會在內部部署機器的群組上執行評量，以瞭解它們是否已準備好進行遷移以 Azure Migrate。

## <a name="how-do-i-run-an-assessment"></a>如何? 執行評估嗎？
您可以使用 Azure Migrate：伺服器評估或另一個 Azure 或協力廠商工具來執行評估。 建立 Azure Migrate 專案之後，您可以新增所需的工具。 [深入了解](how-to-add-tool-first-time.md)

### <a name="collect-compute-data"></a>收集計算資料

計算設定的效能資料會依照下列方式收集：

1. [Azure Migrate 設備](migrate-appliance.md)會收集即時取樣點：

    - **Vmware vm**：針對 vmware vm，Azure Migrate 設備會收集每20秒間隔的即時取樣點。
    - **Hyper-v vm**：針對 hyper-v vm，會每隔30秒收集一次即時取樣點。
    - **實體伺服器**：針對實體伺服器，即時取樣點會每隔五分鐘收集一次。 
    
2. 設備會匯總取樣點（20秒、30秒、5分鐘），以每隔10分鐘建立一個資料點。 若要建立單一資料點，設備會從所有範例中選取尖峰值，然後將其傳送至 Azure。
3. 伺服器評估會儲存上個月的所有10分鐘範例點。
4. 當您建立評估時，伺服器評量會根據*效能歷程記錄*和*百分位數使用率*的百分位數值，識別要用於適當大小的適當資料點。

    - 例如，如果效能歷程記錄設定為一周，而百分位數使用率是第95個百分位數，伺服器評量會以遞增順序排序上周的10分鐘取樣點，並挑選第95個百分位數值來進行適當的調整。 
    - 第95個百分位數值可確保您忽略任何極端值，這可能會在您挑選第99個百分位數時包含。
    - 如果您想要挑選週期的尖峰使用量，而不想錯過任何極端值，您應該選取第99個百分位數來表示百分位數的使用率。

5. 這個值會乘以緩和因數，以取得每個計量（CPU 使用率、記憶體使用率、磁片 IOPS （讀取和寫入）、磁片輸送量（讀取和寫入），以及網路輸送量（輸入和輸出）的有效效能使用率資料，這是設備收集。

若要在伺服器評估中執行評量，您要準備進行內部部署和 Azure 的評估，並設定 Azure Migrate 設備以持續探索內部部署機器。 探索到機器之後，您可以將它們收集成群組來進行評估。 如需更詳細且高度信賴的評量，您可以將電腦之間的相依性視覺化並對應，以瞭解如何加以遷移。

- 瞭解如何執行[VMware vm](tutorial-prepare-vmware.md)、 [hyper-v vm](tutorial-prepare-hyper-v.md)和[實體伺服器](tutorial-prepare-physical.md)的評量。
- 瞭解如何評估[使用 CSV](tutorial-assess-import.md)檔案匯入的伺服器。
- 瞭解如何設定相依性[視覺效果](concepts-dependency-visualization.md)。

## <a name="assessments-in-server-assessment"></a>伺服器評估中的評量 

您使用 Azure Migrate Server 評估所建立的評量是資料的時間點快照集。 伺服器評估工具提供兩種類型的評量。

**評量類型** | **詳細資料** | **Data**
--- | --- | ---
**以效能為基礎** | 根據所收集的效能資料做出建議的評量 | VM 大小建議是根據 CPU 和記憶體使用量資料。<br/><br/> 磁片類型建議（標準 HDD/SSD 或 premium 受控磁片）是以內部部署磁片的 IOPS 和輸送量為基礎。
**依內部部署** | 不使用效能資料來提出建議的評量。 | VM 大小建議是根據內部部署 VM 大小<br/><br> 建議的磁片類型是以評估的選取儲存體類型為基礎。

## <a name="collecting-performance-data"></a>收集效能資料

效能資料的收集方式如下：

1. [Azure Migrate 設備](migrate-appliance.md)會收集即時取樣點：

    - **Vmware vm**：針對 vmware vm，Azure Migrate 設備會收集每20秒間隔的即時取樣點。
    - **Hyper-v vm**：針對 hyper-v vm，會每隔30秒收集一次即時取樣點。
    - **實體伺服器**：針對實體伺服器，即時取樣點會每隔五分鐘收集一次。 
    
2. 設備會匯總取樣點（20秒、30秒、5分鐘），以每隔10分鐘建立一個資料點。 若要建立單一資料點，設備會從所有範例中選取尖峰值，然後將其傳送至 Azure。
3. 伺服器評估會儲存上個月的所有10分鐘範例點。
4. 當您建立評估時，伺服器評量會根據*效能歷程記錄*和*百分位數使用率*的百分位數值，識別要用於適當大小的適當資料點。

    - 例如，如果效能歷程記錄設定為一周，而百分位數使用率是第95個百分位數，伺服器評量會以遞增順序排序上周的10分鐘取樣點，並挑選第95個百分位數值來進行適當的調整。 
    - 第95個百分位數值可確保您忽略任何極端值，這可能會在您挑選第99個百分位數時包含。
    - 如果您想要挑選週期的尖峰使用量，而不想錯過任何極端值，您應該選取第99個百分位數來表示百分位數的使用率。

5. 這個值會乘以緩和因數，以取得每個計量（CPU 使用率、記憶體使用率、磁片 IOPS （讀取和寫入）、磁片輸送量（讀取和寫入），以及網路輸送量（輸入和輸出）的有效效能使用率資料，這是設備收集。
## <a name="whats-in-an-assessment"></a>評估包含什麼？

以下是 Azure Migrate：伺服器評估中的評量所包含的內容。

**屬性** | **詳細資料**
--- | ---
**目標位置** | 您要遷移的目標位置。伺服器評估目前支援下列目標 Azure 區域：<br/><br/> 澳大利亞東部、澳大利亞東南部、巴西南部、加拿大中部、加拿大東部、印度中部、美國中部、中國東部、中國北部、東亞、美國東部、東部美國2、德國中部、德國東北部、日本東部、日本西部、韓國中部、南韓南部、北部美國中部、北歐、美國中南部、東南亞、印度南部、英國南部、英國西部、US Gov 亞利桑那州、US Gov 德克薩斯州、US Gov 維吉尼亞州、美國中西部、西歐、印度西部、美國西部和 West 美國2。
*目標儲存體磁片（依大小調整）* * | 要在 Azure 中用於儲存的磁片類型。 <br/><br/> 將目標儲存體磁片指定為高階受控、標準 SSD 受控，或管理標準 HDD。
**目標儲存體磁片（以效能為基礎的調整大小）** | 將目標儲存體磁片的類型指定為 [自動]、[premium 管理]、[標準 HDD 管理] 或 [標準 SSD 受控]。<br/><br/> **自動**：磁片建議是根據磁片的效能資料（每秒輸入/輸出作業（IOPS）和輸送量）。<br/><br/>**Premium/standard**：評估會建議所選儲存體類型內的磁片 SKU。<br/><br/> 如果您想要達到99.9% 的單一實例 VM SLA，請考慮使用 premium 受控磁片。 這可確保將評估中的所有磁片都建議為高階受控磁片。<br/><br/> Azure Migrate 只支援將受控磁碟用於進行移轉評估。
**保留實例（RIs）** | 指定 Azure 中的[保留實例](https://azure.microsoft.com/pricing/reserved-vm-instances/)，讓評估中的成本估計會將 RI 折扣納入考慮。<br/><br/> RIs 目前僅支援 Azure Migrate 中的隨用隨付供應專案。
**調整大小準則** | 用來在 Azure 中適當調整 VM 的大小。<br/><br/> [使用中]、[大小] 或 [以效能為基礎的大小調整]。
**效能歷程記錄** | 用於以效能為基礎的大小調整。 指定評估效能資料時所使用的持續時間。
**百分位數使用率** | 用於以效能為基礎的大小調整。 指定要用於適當調整大小之效能範例的百分位數值。 
**VM 系列** | 指定您想要針對適當調整大小考慮的 Azure VM 系列。 例如，如果您在 Azure 中沒有需要 A 系列 Vm 的生產環境，您可以從清單或數列中排除 A 系列。
**緩和因數** | 評估期間使用的緩衝區。 適用于 Vm 的機器使用量資料（CPU、記憶體、磁片和網路）。 其適用于季節性使用量、簡短效能歷程記錄等問題，而且未來可能會增加。<br/><br/> 例如，具有20% 使用率的10核心 VM 通常會產生兩個核心的 VM。 使用 2.0 x 的緩和因數，其結果會改為四核心 VM。
**供應項目** | 顯示您所註冊的[Azure 供應](https://azure.microsoft.com/support/legal/offer-details/)專案。 伺服器評估會據以預估成本。
**貨幣** | 您帳戶的帳單貨幣。
**折扣 (%)** | 列出您在 Azure 供應專案上所收到的任何訂用帳戶特定折扣。 預設設定為 0%。
**VM 運作時間** | 如果 Azure Vm 一天不會執行24小時，一周7天，您可以指定將會執行的持續時間（每月天數和每日小時數）。 成本預估會據此處理。<br/><br/> 預設值是每月 31 天和每天 24 小時。
**Azure Hybrid Benefit** | 指定您是否擁有軟體保證，以及是否符合[Azure Hybrid Benefit](https://azure.microsoft.com/pricing/hybrid-use-benefit/)的資格。 如果設定為 [是] （預設設定），則會考慮 Windows Vm 的非 Windows Azure 價格。

請參閱使用伺服器評估來建立評量[的最佳作法](best-practices-assessment.md)。

## <a name="how-are-assessments-calculated"></a>如何計算評量？ 

Azure Migrate 中的評量：使用針對內部部署機器所收集的中繼資料來計算伺服器評估。 如果您在使用匯入的機器上執行評量。CSV 檔案：您可以提供計算的中繼資料。 計算會在三個階段發生：

1. **計算 Azure 就緒**：評估機器是否適合遷移至 Azure。
2. **計算大小調整建議**：估計計算、儲存體和網路大小。 
2. **計算每月成本**：計算在遷移後於 Azure 中執行機器的預估每月計算和儲存成本。

計算的順序是，而且電腦伺服器會在通過前一個階段時，才會移到稍後的階段。 例如，如果伺服器未通過 Azure 準備，它會標示為不適合 Azure，而且不會針對該伺服器進行調整大小和成本。



## <a name="calculate-readiness"></a>計算準備就緒

並非所有機器都適合在 Azure 中執行。 伺服器評估會評估每個內部部署機器，並為其指派一個就緒分類。 
- **適用于 azure**：機器可以依現有方式遷移至 azure，而不需要任何變更。 它會在 Azure 中以完整 Azure 支援開始。
- **有條件地準備好使用 azure**：電腦可能會在 azure 中啟動，但可能不會有完整的 Azure 支援。 例如，在 Azure 中不支援執行舊版 Windows Server 的電腦。 將這些機器遷移至 Azure 之前，您必須先小心。 遵循評估中建議的補救指導方針來修正準備就緒的問題。
- **尚未準備好用於 azure**：電腦不會在 azure 中啟動。 例如，如果內部部署機器磁片大於 64-Tb，則無法裝載于 Azure 中。 請遵循補救指引來修正此問題，然後再進行遷移。 
- 已**就緒不明**：因為中繼資料不足，所以 Azure Migrate 無法判斷機器是否已就緒。

為了計算就緒程度，伺服器評估會檢查下表中摘要說明的機器屬性和作業系統設定。 

### <a name="machine-properties"></a>機器屬性

伺服器評估會檢查內部部署 VM 的下列屬性，以判斷它是否可以在 Azure 上執行。

**屬性** | **詳細資料** | **Azure 移轉整備程度狀態**
--- | --- | ---
**開機類型** | Azure 支援開機類型為 BIOS 而不是 UEFI 的 Vm。 | 有條件地準備開機類型為 UEFI。
**核心** | 機器的核心數目必須等於或小於 Azure VM 支援的核心數目上限（128）。<br/><br/> 如果有提供效能記錄，則 Azure Migrate 會將已使用的核心納入考量，進行比較。 如果評量設定已指定緩和因數，則會將使用的核心數目乘以緩和因數。<br/><br/> 如果沒有效能歷程記錄，Azure Migrate 會使用已配置的核心，而不套用緩和因數。 | 小於或等於限制便就緒。
**記憶體** | 機器記憶體大小必須等於或小於 Azure VM 允許之 Azure M 系列 Standard_M128m&nbsp;<sup>2</sup>）的最大記憶體（3892 gb）。 [詳細資訊](https://docs.microsoft.com/azure/virtual-machines/windows/sizes)。<br/><br/> 如果有提供效能記錄，Azure Migrate 會將已使用的記憶體納入考量，進行比較。 如果已指定緩和因數，則會將使用的記憶體乘以緩和因數。<br/><br/> 如果沒有歷程記錄，則會使用配置的記憶體，而不會套用緩和因數。<br/><br/> | 在限制內便就緒。
**存放磁碟** | 磁片的配置大小必須是 32 TB 或更少。 雖然 Azure 支援具有 Ultra SSD 磁片的 64-TB 磁片，Azure Migrate：伺服器評量目前會檢查 32 TB 是否為磁片大小限制，因為它並不支援 Ultra SSD。 <br/><br/> 連接至電腦的磁片數目必須是65或更少，包括 OS 磁片。 | 在限制內便就緒。
**網路功能** | 電腦必須連接32或較少的網路介面（Nic）。 | 在限制內便就緒。

### <a name="guest-operating-system"></a>客體作業系統
除了 VM 屬性，伺服器評估也會查看機器的客體作業系統，以判斷它是否可以在 Azure 上執行。

> [!NOTE]
> 針對 VMware Vm，伺服器評估會使用在 vCenter Server 中為 VM 指定的作業系統來處理虛擬機器作業系統分析。 對於在 VMware 上執行的 Linux Vm，它目前不會識別虛擬作業系統的確切核心版本。

伺服器評估會使用下列邏輯來識別以作業系統為基礎的 Azure 就緒程度。

**作業系統** | **詳細資料** | **Azure 移轉整備程度狀態**
--- | --- | ---
Windows Server 2016 與所有 SP | Azure 提供完整支援。 | 可供 Azure 使用
Windows Server 2012 R2 與所有 SP | Azure 提供完整支援。 | 可供 Azure 使用
Windows Server 2012 與所有 SP | Azure 提供完整支援。 | 可供 Azure 使用
Windows Server 2008 R2，含所有 SP | Azure 提供完整支援。| 可供 Azure 使用
Windows Server 2008 (32 位元和 64 位元) | Azure 提供完整支援。 | 可供 Azure 使用
Windows Server 2003、2003 R2 | 這些作業系統已通過支援的結束日期，並且需要[自訂支援合約（CSA）](https://aka.ms/WSosstatement)以在 Azure 中支援。 | 有條件地準備好 Azure。 在遷移至 Azure 之前，請考慮升級 OS。
Windows 2000、98、95、NT、3.1、MS-DOS | 這些作業系統已通過支援的結束日期。 電腦可能會在 Azure 中啟動，但 Azure 不會提供作業系統支援。 | 有條件地準備好 Azure。 我們建議您先升級 OS，再遷移至 Azure。
Windows Client 7、8 及 10 | Azure [僅對 Visual Studio 訂用帳戶](https://docs.microsoft.com/azure/virtual-machines/windows/client-images)提供支援。 | 可有條件地供 Azure 使用
Windows 10 專業版桌面 | Azure 對[多租用戶主機權限](https://docs.microsoft.com/azure/virtual-machines/windows/windows-desktop-multitenant-hosting-deployment)提供支援。 | 可有條件地供 Azure 使用
Windows Vista、XP Professional | 這些作業系統已通過支援的結束日期。 電腦可能會在 Azure 中啟動，但 Azure 不會提供作業系統支援。 | 有條件地準備好 Azure。 我們建議您先升級 OS，再遷移至 Azure。
Linux | Azure 認同這些 [Linux 作業系統](../virtual-machines/linux/endorsed-distros.md)。 其他 Linux 作業系統可能會在 Azure 中啟動，但我們建議您在遷移至 Azure 之前，先將作業系統升級為背書版本。 | 如果版本受到認同，則可供 Azure 使用。<br/><br/>如果版本未受到認同，則有條件地可供使用。
其他作業系統<br/><br/> 例如，Oracle Solaris、Apple macOS 等、FreeBSD 等等。 | Azure 並未認可這些作業系統。 電腦可能會在 Azure 中啟動，但 Azure 不會提供作業系統支援。 | 有條件地準備好 Azure。 我們建議您在遷移至 Azure 之前，先安裝支援的作業系統。  
在 vCenter Server 中作業系統指定為**其他** | Azure Migrate 無法在此情況下識別作業系統。 | 整備程度未知。 請確保 Azure 支援 VM 內執行的作業系統。
32 位元作業系統 | 電腦可能會在 Azure 中啟動，但 Azure 可能無法提供完整的支援。 | 有條件地準備好 Azure。 在遷移至 Azure 之前，請考慮將電腦的 OS 從32位 OS 升級至64位作業系統。

## <a name="calculate-sizing-as-is-on-premises"></a>計算大小（依內部部署的情況）

電腦標示為 [準備好用於 Azure] 之後，伺服器評估會進行大小調整建議，以識別 Azure VM 和磁片 SKU。 如果您使用的是內部部署調整大小，伺服器評估並不會考慮 Vm 和磁片的效能歷程記錄。

**計算大小**：它會根據內部部署所配置的大小來配置 AZURE VM SKU。
**儲存體/磁片大小**：伺服器評估會查看評量屬性（標準 HDD/SSD/premium）中指定的儲存體類型，並據此建議磁片類型。 預設儲存體類型為 [premium 磁片]。
**網路大小調整**：伺服器評估會考慮內部部署機器上的網路介面卡。


## <a name="calculate-sizing-performance-based"></a>計算大小（以效能為基礎）

將機器標示為適用于 Azure 之後，如果您使用效能為基礎的大小調整，伺服器評估會進行大小調整建議，如下所示：

- 伺服器評估會考慮機器的效能歷程記錄，以識別 Azure 中的 VM 大小和磁片類型。
- 如果使用 CSV 檔案匯入伺服器，則會使用您指定的值。 如果您已過度配置內部部署機器，則此方法特別有用，其使用率實際上很低，而您想要在 Azure 中適當調整 VM 的大小，以節省成本。 
- 如果您不想要使用效能資料，請依照上一節所述，將大小調整準則重設為 [內部部署]。

### <a name="calculate-storage-sizing"></a>計算儲存體大小

針對儲存體大小調整，Azure Migrate 嘗試將連接至機器的每個磁片對應至 Azure 中的磁片，並依照下列方式運作：

1. 伺服器評估會新增磁片的讀取和寫入 IOPS，以取得所需的總 IOPS。 同樣地，它會新增讀取和寫入輸送量值，以取得每個磁片的總輸送量。
2. 如果您已將儲存體類型指定為自動，根據有效的 IOPS 和輸送量值，伺服器評估會決定磁片是否應對應至 Azure 中的標準 HDD、標準 SSD 或 premium 磁片。 如果儲存體類型設定為標準 HDD/SSD/Premium，伺服器評估會嘗試在選取的儲存體類型（標準 HDD/SSD/Premium 磁片）中尋找磁片 SKU。
3. 選取的磁片如下所示：
    - 如果伺服器評估找不到具有所需 IOPS 和輸送量的磁片，它會將機器標示為不適合 Azure。
    - 如果伺服器評估找到一組適當的磁片，它會選取支援評量設定中指定之位置的磁片。
    - 如果有多個合格的磁片，伺服器評估會選取成本最低的磁片。
    - 如果任何磁片的效能資料無法使用，磁片的設定資料（磁片大小）會用來在 Azure 中尋找標準 SSD 磁片。

### <a name="calculate-network-sizing"></a>計算網路大小

伺服器評估會嘗試尋找可支援附加至內部部署機器的網路介面卡數目，以及這些網路介面卡所需效能的 Azure VM。
- 為了取得內部部署 VM 的有效網路效能，伺服器評量會匯總所有網路介面卡上每秒傳輸的資料（MBps）（網路輸出），並套用緩和因數。 它會使用此數位來尋找可支援所需網路效能的 Azure VM。
- 除了網路效能，伺服器評估也會考慮 Azure VM 是否可支援所需的網路介面卡數目。
- 如果沒有可用的網路效能資料，伺服器評量只會考慮 VM 大小的網路介面卡計數。


### <a name="calculate-compute-sizing"></a>計算計算大小

在計算儲存體和網路需求之後，伺服器評估會考慮 CPU 和記憶體需求，以在 Azure 中尋找適當的 VM 大小。
- Azure Migrate 會查看有效運用的核心和記憶體，以便在 Azure 中尋找適當的 VM 大小。
- 如果找不到合適的大小，便會將機器標示為不適合 Azure。
- 如果找到合適的大小，Azure Migrate 會套用儲存體與網路計算。 然後，它會針對最終的 VM 大小建議套用 [位置] 和 [定價層] 設定。
- 如果有多個符合資格的 Azure VM 大小，建議使用成本最低的那個。


### <a name="calculate-confidence-ratings"></a>計算信賴評等

Azure Migrate 中的每個以效能為基礎的評量，都與信賴評等相關聯，範圍從一（最低）到五顆星（最高）。
- 根據計算評量所需的資料點可用性，每個評量都會指派信賴評等。
- 評量的信賴評等可協助您評估 Azure Migrate 提供的大小建議之可靠性。
- 信賴評等不適用於*作為內部部署*評量。
- 針對以效能為基礎的大小調整，伺服器評量需求：
    - CPU 和 VM 記憶體的使用量資料。
    - 連接至 VM 的每個磁片的磁片 IOPS 和輸送量資料。
    - 針對連接至 VM 的每個網路介面卡，處理以效能為基礎之大小調整的網路 i/o。

   如果 vCenter Server 中有任何這些使用量號碼無法使用，則大小建議可能不可靠。

根據可用資料點的百分比，評量的信賴評等如下所示。

   **資料點的可用性** | **信賴評等**
   --- | ---
   0-20% | 1 顆星
   21-40% | 2 顆星
   41-60% | 3 顆星
   61-80% | 4 顆星
   81-100% | 5 顆星

> [!NOTE]
> 信賴評等不會指派給使用匯入的伺服器評量。CSV 檔案到 Azure Migrate。 

#### <a name="low-confidence-ratings"></a>低信賴等級

以下是評估可能獲得低信賴等級的幾個原因：

- 您在建立評量的持續時間內，未針對您的環境進行分析。 例如，如果您建立的評量將效能持續時間設定為一天，則在開始探索所有資料點之後，您必須至少等候一天，以進行收集。
- 部分 VM 在評量計算期間關閉。 如果有任何 Vm 在某段期間內關閉，伺服器評估就無法收集該期間的效能資料。
- 有些 Vm 是在計算評估期間建立的。 例如，如果您為上個月的效能歷程記錄建立了評量，但有些 Vm 只是在一周前于環境中建立，則新 Vm 的效能歷程記錄將不會存在於完整的持續時間內。

> [!NOTE]
> 如果任何評量的信賴評等少於五顆星，建議您至少等候一天，讓設備分析環境，然後重新計算評量。 如果您不這麼做，以效能為基礎的大小調整可能不可靠。 在此情況下，建議您將評量切換為內部部署調整大小。

## <a name="calculate-monthly-costs"></a>計算每月成本

調整大小建議完成後，Azure Migrate 會計算遷移後的計算和儲存成本。

- **計算成本**：使用建議的 Azure VM 大小時，Azure Migrate 會使用計費 API 來計算虛擬機器的每月成本。
    - 計算時會將作業系統、軟體保證、保留執行個體、VM 運作時間、位置和貨幣設定納入考量。
    - 它會匯總所有機器的成本，以計算每月總計算成本。
- **儲存成本**：機器的每月儲存成本計算方式是匯總連接至機器的所有磁片的每月成本，如下所示：
    - 伺服器評估會匯總所有機器的儲存成本，以計算每月儲存成本總計。
    - 目前，計算不會考慮評量設定中指定的供應專案。

成本會以評量設定中指定的貨幣顯示。


## <a name="next-steps"></a>後續步驟

請[參閱](best-practices-assessment.md)建立評量的最佳做法。 
