---
title: Azure Migrate 中的評量計算 | Microsoft Docs
description: 概括介紹 Azure Migrate 服務中的評量計算。
author: rayne-wiselman
ms.service: azure-migrate
ms.topic: conceptual
ms.date: 08/06/2019
ms.author: raynew
ms.openlocfilehash: 4511c42514a5399d41029b61297bd4c1b0b63d9a
ms.sourcegitcommit: 3073581d81253558f89ef560ffdf71db7e0b592b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/06/2019
ms.locfileid: "68827539"
---
# <a name="assessment-calculations-in-azure-migrate"></a>Azure Migrate 中的評量計算

[Azure Migrate](migrate-services-overview.md)提供中央中樞來追蹤內部部署應用程式和工作負載的探索、評估和遷移。 它也會將您的私用和公用雲端實例追蹤到 Azure。 中樞提供評估和遷移的 Azure Migrate 工具, 以及協力廠商獨立軟體廠商 (ISV) 產品。

伺服器評估是 Azure Migrate 中的一項工具, 可評估要遷移至 Azure 的內部部署伺服器。 本文提供評量計算方式的相關資訊。

## <a name="whats-in-an-assessment"></a>評估包含什麼？

**屬性** | **詳細資料**
--- | ---
**目標位置** | 指定您要遷移至的 Azure 位置。<br/><br/>伺服器評估目前支援下列目的地區域:澳大利亞東部、澳大利亞東南部、巴西南部、加拿大中部、加拿大東部、印度中部、美國中部、中國東部、中國北部、東亞、美國東部、東部美國2、德國中部、德國東北部、日本東部、日本西部、韓國中部、南韓南部、北部美國中部、北歐、美國中南部、東南亞、印度南部、英國南部、英國西部、US Gov 亞利桑那州、US Gov 德克薩斯州、US Gov 維吉尼亞州、美國中西部、西歐、印度西部、美國西部和 West 美國2。
**儲存體類型** | 指定您想要在 Azure 中用來儲存的磁片類型。 <br/><br/> 針對內部部署調整大小, 您可以將目標儲存體磁片的類型指定為 [Premium 管理]、[標準 SSD 管理] 或 [標準 HDD 管理]。 針對以效能為基礎的大小調整, 您可以將目標儲存體磁片的類型指定為自動、高階管理、標準 HDD 管理或標準 SSD 管理。 當您將儲存體類型指定為 [自動] 時, 磁片建議是根據磁片的效能資料: 每秒的輸入/輸出作業 (IOPS) 和輸送量。 <br/><br/>如果您將儲存體類型指定為 [Premium] 或 [標準], 則評量會建議選取的儲存體類型內的磁片 SKU。 如果您想要達到 99.9% 的單一實例 VM SLA, 您可能會想要將儲存體類型指定為 Premium 受控磁片。 這可確保建議評量中的所有磁碟成為進階受控磁碟。 請注意，Azure Migrate 只支援將受控磁碟用於進行移轉評估。
**保留實例 (RIs)** | 此屬性可協助您指定 Azure 中的[保留實例](https://azure.microsoft.com/pricing/reserved-vm-instances/)。 評估成本之後, 請將 RI 折扣納入考慮。 RIs 目前僅支援 Azure Migrate 中的隨用隨付供應專案。
**調整大小準則** | 設定要用來為 Azure*適當調整 vm 大小*的準則。 您可以選擇以*效能為基礎*的大小調整, 或將 vm 大小設*為內部部署*, 而不考慮效能歷程記錄。
**效能歷程記錄** | 設定評估電腦效能資料時所要考慮的持續時間。 只有在調整大小準則是以效能為*基礎*時, 此屬性才適用。
**百分位數使用率** | 指定要針對適當調整大小所考慮之效能範例集的百分位數值。 只有在調整大小是以效能為基礎的情況下, 才適用此屬性。
**VM 系列** | 可讓您指定要針對適當調整大小所考慮的 VM 系列。 例如, 如果您的生產環境不打算遷移至 Azure 中的 A 系列 Vm, 您可以從清單或數列中排除 A 系列, 而且只會在選取的數列中進行右大小調整。
**緩和因數** | Azure Migrate Server 評估會考慮在評估期間的緩衝區 (緩和因數)。 此緩衝區適用於 VM 的機器使用量資料 (CPU、記憶體、磁碟和網路)。 緩和因數會考量各個問題，例如季節性使用量、簡短的效能歷程記錄，以及未來可能增加的使用量。<br/><br/> 以 10 核心的 VM 為例，如果使用率為 20%，一般即相當於一個 2 核心的 VM。 但如果緩和因數為 2.0 x，則結果為 4 核心的 VM。
**供應項目** | 顯示您所註冊的[Azure 供應](https://azure.microsoft.com/support/legal/offer-details/)專案。 Azure Migrate 會據以預估成本。
**貨幣** | 顯示您帳戶的帳單貨幣。
**折扣 (%)** | 列出您在 Azure 供應專案上所收到的任何訂用帳戶特定折扣。 預設設定為 0%。
**VM 運作時間** | 如果您的 Vm 每天24小時執行一次, 在 Azure 中一周7天, 您可以指定其執行的持續時間 (每月天數和每天時數), 並據此處理成本預估值。 預設值是每月 31 天和每天 24 小時。
**Azure Hybrid Benefit** | 指定您是否擁有軟體保證, 以及是否符合[Azure Hybrid Benefit](https://azure.microsoft.com/pricing/hybrid-use-benefit/)的資格。 如果設定為 [是]，則會考慮對 Windows VM 使用非 Windows Azure 價格。 預設設定為 [是]。

## <a name="how-are-assessments-calculated"></a>如何計算評量？

Azure Migrate Server 評估中的評量是使用針對內部部署伺服器所收集的中繼資料來計算。 評估計算會以三個階段處理。 針對每部伺服器, 評量計算會從 Azure 適用性分析開始, 然後是調整大小, 最後是每月成本估計。 伺服器只會在通過前一個階段時, 才會移到稍後的階段。 例如, 如果伺服器未通過 Azure 適用性檢查, 就會標示為不適合 Azure, 而且不會針對該伺服器進行調整大小和成本。

## <a name="azure-suitability-analysis"></a>Azure 適用性分析

並非所有機器都適合在 Azure 中執行。 伺服器評估會評估每個內部部署機器, 以瞭解其適用于 Azure 遷移的適用性。 它也會將每個評估的電腦指派給下列其中一個適用性類別:
- **可供 Azure 使用**：機器可以依自己的方式遷移至 Azure, 而不需要任何變更。 它會在 Azure 中以完整 Azure 支援開始。
- **有條件地準備好 Azure**:電腦可能會在 Azure 中啟動, 但可能不會有完整的 Azure 支援。 例如, 在 Azure 中不支援執行舊版 Windows Server 的電腦。 將這些機器遷移至 Azure 之前, 您必須先小心, 並遵循評估中建議的補救指引來修正準備就緒問題。
- **未備妥供 Azure 使用**：電腦將不會在 Azure 中啟動。 例如, 如果內部部署機器的磁片已附加超過 64 tb, 則無法裝載于 Azure 上。 您必須遵循評估中建議的補救指導方針, 在將機器遷移至 Azure 之前修正準備問題。 對於標示為未備妥供 Azure 使用的機器，未完成適當的大小調整和成本估計。
- **移轉整備程度未知**：Azure Migrate 因為從內部部署環境收集的中繼資料不足, 所以無法判斷機器是否已就緒。

伺服器評估會檢查機器屬性和客體作業系統, 以判斷內部部署機器的 Azure 就緒程度。

### <a name="machine-properties"></a>機器屬性

伺服器評估會檢查內部部署 VM 的下列屬性, 以判斷它是否可以在 Azure 上執行。

**屬性** | **詳細資料** | **Azure 移轉整備程度狀態**
--- | --- | ---
**開機類型** | Azure 支援開機類型為 BIOS 而不是 UEFI 的 Vm。 | 有條件地準備開機類型為 UEFI。
**核心** | 機器的核心數目必須等於或小於 Azure VM 支援的核心數目上限 (128)。<br/><br/> 如果有提供效能記錄，則 Azure Migrate 會將已使用的核心納入考量，進行比較。 如果評量設定已指定緩和因數，則會將使用的核心數目乘以緩和因數。<br/><br/> 如果沒有效能歷程記錄, Azure Migrate 會使用已配置的核心, 而不套用緩和因數。 | 小於或等於限制便就緒。
**記憶體** | 機器記憶體大小必須等於或小於 azure VM 允許的記憶體上限 (azure M 系列 Standard_M128m&nbsp; <sup>2</sup>上的 3892 gb)。 [深入了解](https://docs.microsoft.com/azure/virtual-machines/windows/sizes)。<br/><br/> 如果有提供效能記錄，Azure Migrate 會將已使用的記憶體納入考量，進行比較。 如果已指定緩和因數，則會將使用的記憶體乘以緩和因數。<br/><br/> 如果沒有歷程記錄, 則會使用配置的記憶體, 而不會套用緩和因數。<br/><br/> | 在限制內便就緒。
**存放磁碟** | 磁片的配置大小必須是 32 TB 或更少。 雖然 Azure 支援具有 Ultra SSD 磁片的 64 TB 磁片, Azure Migrate:伺服器評估目前會檢查 32 TB 是否為磁片大小限制, 因為它尚不支援 Ultra SSD。 <br/><br/> 連接至電腦的磁片數目必須是65或更少, 包括 OS 磁片。 | 在限制內便就緒。
**網路功能** | 電腦必須連接32或較少的網路介面 (Nic)。 | 在限制內便就緒。

### <a name="guest-operating-system"></a>客體作業系統
除了 VM 屬性, 伺服器評估也會查看機器的客體作業系統, 以判斷它是否可以在 Azure 上執行。

> [!NOTE]
> 針對 VMware Vm, 伺服器評估會使用在 vCenter Server 中為 VM 指定的作業系統來處理虛擬機器作業系統分析。 對於在 VMware 上執行的 Linux Vm, 它目前不會識別虛擬作業系統的確切核心版本。

伺服器評估會使用下列邏輯來識別以作業系統為基礎的 Azure 就緒程度。

**作業系統** | **詳細資料** | **Azure 移轉整備程度狀態**
--- | --- | ---
Windows Server 2016 與所有 SP | Azure 提供完整支援。 | 可供 Azure 使用
Windows Server 2012 R2 與所有 SP | Azure 提供完整支援。 | 可供 Azure 使用
Windows Server 2012 與所有 SP | Azure 提供完整支援。 | 可供 Azure 使用
Windows Server 2008 R2，含所有 SP | Azure 提供完整支援。| 可供 Azure 使用
Windows Server 2008 (32 位元和 64 位元) | Azure 提供完整支援。 | 可供 Azure 使用
Windows Server 2003、2003 R2 | 這些作業系統已通過支援的結束日期, 並且需要[自訂支援合約 (CSA)](https://aka.ms/WSosstatement)以在 Azure 中支援。 | 有條件地準備好 Azure。 在遷移至 Azure 之前, 請考慮升級 OS。
Windows 2000、98、95、NT、3.1、MS-DOS | 這些作業系統已通過支援的結束日期。 電腦可能會在 Azure 中啟動, 但 Azure 不會提供作業系統支援。 | 有條件地準備好 Azure。 我們建議您先升級 OS, 再遷移至 Azure。
Windows Client 7、8 及 10 | Azure [僅對 Visual Studio 訂用帳戶](https://docs.microsoft.com/azure/virtual-machines/windows/client-images)提供支援。 | 可有條件地供 Azure 使用
Windows 10 專業版桌面 | Azure 對[多租用戶主機權限](https://docs.microsoft.com/azure/virtual-machines/windows/windows-desktop-multitenant-hosting-deployment)提供支援。 | 可有條件地供 Azure 使用
Windows Vista、XP Professional | 這些作業系統已通過支援的結束日期。 電腦可能會在 Azure 中啟動, 但 Azure 不會提供作業系統支援。 | 有條件地準備好 Azure。 我們建議您先升級 OS, 再遷移至 Azure。
Linux | Azure 認同這些 [Linux 作業系統](../virtual-machines/linux/endorsed-distros.md)。 其他 Linux 作業系統可能會在 Azure 中啟動, 但我們建議您在遷移至 Azure 之前, 先將作業系統升級為背書版本。 | 如果版本受到認同，則可供 Azure 使用。<br/><br/>如果版本未受到認同，則有條件地可供使用。
其他作業系統<br/><br/> 例如，Oracle Solaris、Apple Mac OS 等、FreeBSD 等。 | Azure 並未認可這些作業系統。 電腦可能會在 Azure 中啟動, 但 Azure 不會提供作業系統支援。 | 有條件地準備好 Azure。 我們建議您在遷移至 Azure 之前, 先安裝支援的作業系統。  
在 vCenter Server 中作業系統指定為**其他** | Azure Migrate 無法在此情況下識別作業系統。 | 整備程度未知。 請確保 Azure 支援 VM 內執行的作業系統。
32 位元作業系統 | 電腦可能會在 Azure 中啟動, 但 Azure 可能無法提供完整的支援。 | 有條件地準備好 Azure。 在遷移至 Azure 之前, 請考慮將電腦的 OS 從32位 OS 升級至64位作業系統。

## <a name="sizing"></a>調整大小

將機器標示為可供 Azure 使用之後, 伺服器評估會進行大小調整建議, 這牽涉到識別適用于內部部署 VM 的適當 Azure VM 和磁片 SKU。 這些建議會根據指定的評量屬性而有所不同。

- 如果評估使用以*效能為基礎的大小調整*, Azure Migrate 會考慮機器的效能歷程記錄, 以識別 Azure 中的 VM 大小和磁片類型。 如果您已過度配置內部部署 VM, 此方法特別有用, 但使用率很低, 而您想要在 Azure 中適當調整 VM 的大小, 以節省成本。 這個方法可協助您優化遷移期間的大小。
- 如果您不想要考慮 VM 大小調整的效能資料, 而且想要將內部部署機器視為 Azure, 您可以將調整大小準則設定為 [內部*部署*]。 然後, 伺服器評估會根據內部部署設定來調整 Vm 大小, 而不考慮使用量資料。 在此情況下, 磁片大小的活動是以您在評估屬性 (標準 HDD、標準 SSD 或高階磁片) 中指定的儲存體類型為基礎。

### <a name="performance-based-sizing"></a>以效能為基礎調整大小

針對以效能為基礎的大小調整, 伺服器評估會從連接至 VM 的磁片開始, 接著是網路介面卡。 然後, 它會根據內部部署 VM 的計算需求來對應 Azure VM SKU。 Azure Migrate 設備會分析內部部署環境, 以收集 CPU、記憶體、磁片和網路介面卡的效能資料。

**效能資料收集步驟:**

1. 針對 VMware Vm, Azure Migrate 設備會收集每20秒間隔的即時取樣點。 針對 Hyper-v Vm, 會每隔30秒收集一次即時取樣點。
1. 設備會匯總每10分鐘收集的樣本點, 並將過去10分鐘的最大值傳送至伺服器評估。
1. 伺服器評估會儲存過去一個月的所有10分鐘範例點。 然後, 根據針對 [*效能*歷程] 和 [*百分位數使用率*] 指定的評量屬性, 識別要用於適當調整大小的適當資料點。 例如, 如果效能歷程記錄設定為1天, 而百分位數使用率是第95個百分位數, 則伺服器評估會在最後一天使用10分鐘取樣點, 以遞增順序排序, 並挑選第95個百分位數值來進行右調整大小。
1. 這個值會乘以緩和因數, 以取得每個計量 (CPU 使用率、記憶體使用率、磁片 IOPS (讀取和寫入)、磁片輸送量 (讀取和寫入), 以及網路輸送量 (輸入和輸出) 的有效效能使用率資料, 這是設備收集。

判斷有效使用率值之後, 儲存體、網路和計算大小的處理方式如下所示。

**儲存體大小**:Azure Migrate 嘗試將連接至機器的每個磁碟對應至 Azure 中的磁碟。

> [!NOTE]
> Azure Migrate Server 評估僅支援受控磁片進行評估。

  - 伺服器評估會新增磁片的讀取和寫入 IOPS, 以取得所需的總 IOPS。 同樣地, 它會新增讀取和寫入輸送量值, 以取得每個磁片的總輸送量。
  - 如果您已將儲存體類型指定為自動, 根據有效的 IOPS 和輸送量值, 伺服器評估會決定磁片是否應對應至 Azure 中的標準 HDD、標準 SSD 或 premium 磁片。 如果儲存體類型設定為標準 HDD/SSD/Premium, 伺服器評估會嘗試在選取的儲存體類型 (標準 HDD/SSD/Premium 磁片) 中尋找磁片 SKU。
  - 如果伺服器評估找不到具有所需 IOPS 和輸送量的磁片, 它會將機器標示為不適合 Azure。
  - 如果伺服器評估找到一組適當的磁片, 它會選取支援評量設定中指定之位置的磁片。
  - 如果有多個合格的磁片, 伺服器評估會選取成本最低的磁片。
  - 如果任何磁片的效能資料無法使用, 磁片的設定資料 (磁片大小) 會用來在 Azure 中尋找標準 SSD 磁片。

**網路大小調整**:伺服器評估會嘗試尋找可支援附加至內部部署機器的網路介面卡數目, 以及這些網路介面卡所需效能的 Azure VM。
- 為了取得內部部署 VM 的有效網路效能, 伺服器評量會匯總所有網路介面卡上每秒傳輸的資料 (MBps) (網路輸出), 並套用緩和因數。 它會使用此數位來尋找可支援所需網路效能的 Azure VM。
- 除了網路效能, 伺服器評估也會考慮 Azure VM 是否可支援所需的網路介面卡數目。
- 如果沒有可用的網路效能資料, 伺服器評量只會考慮 VM 大小的網路介面卡計數。

**計算大小**:在計算儲存體和網路需求之後, 伺服器評估會考慮 CPU 和記憶體需求, 以在 Azure 中尋找適當的 VM 大小。
- Azure Migrate 會查看有效運用的核心和記憶體, 以便在 Azure 中尋找適當的 VM 大小。
- 如果找不到合適的大小，便會將機器標示為不適合 Azure。
- 如果找到合適的大小，Azure Migrate 會套用儲存體與網路計算。 然後, 它會針對最終的 VM 大小建議套用 [位置] 和 [定價層] 設定。
- 如果有多個符合資格的 Azure VM 大小，建議使用成本最低的那個。

### <a name="as-on-premises-sizing"></a>作為內部部署調整大小

如果您使用*做為內部部署*調整大小, 伺服器評估不會考慮 vm 和磁片的效能歷程記錄。 相反地, 它會根據內部部署所配置的大小, 配置 Azure 中的 VM SKU。 類似于磁片大小調整, 伺服器評估會查看評量屬性 (標準 HDD/SSD/Premium) 中指定的儲存體類型, 並據此建議磁片類型。 預設儲存體類型為 [Premium 磁片]。

## <a name="confidence-ratings"></a>信賴評等
Azure Migrate 中的每個以效能為基礎的評量, 都與信賴評等相關聯, 範圍從一 (最低) 到五顆星 (最高)。
- 根據計算評量所需的資料點可用性，每個評量都會指派信賴評等。
- 評量的信賴評等可協助您評估 Azure Migrate 提供的大小建議之可靠性。
- 信賴評等不適用於*作為內部部署*評量。
- 針對以效能為基礎的大小調整, 伺服器評量需求:
    - CPU 和 VM 記憶體的使用量資料。
    - 連接至 VM 的每個磁片的磁片 IOPS 和輸送量資料。
    - 針對連接至 VM 的每個網路介面卡, 處理以效能為基礎之大小調整的網路 i/o。

   如果 vCenter Server 中有任何這些使用量號碼無法使用, 則大小建議可能不可靠。

根據可用資料點的百分比, 評量的信賴評等如下所示。

   **資料點的可用性** | **信賴評等**
   --- | ---
   0-20% | 1 顆星
   21-40% | 2 顆星
   41-60% | 3 顆星
   61-80% | 4 顆星
   81-100% | 5 顆星

### <a name="low-confidence-ratings"></a>低信賴等級

以下是評估可能獲得低信賴等級的幾個原因:

- 您在建立評量的持續時間內, 未針對您的環境進行分析。 例如, 如果您建立的評量將效能持續時間設定為一天, 則在開始探索所有資料點之後, 您必須至少等候一天, 以進行收集。
- 部分 VM 在評量計算期間關閉。 如果有任何 Vm 在某段期間內關閉, 伺服器評估就無法收集該期間的效能資料。
- 有些 Vm 是在計算評估期間建立的。 例如, 如果您為上個月的效能歷程記錄建立了評量, 但有些 Vm 只是在一周前于環境中建立, 則新 Vm 的效能歷程記錄將不會存在於完整的持續時間內。

> [!NOTE]
> 如果任何評量的信賴評等少於五顆星, 建議您至少等候一天, 讓設備分析環境, 然後重新計算評量。 如果您不這麼做, 以效能為基礎的大小調整可能不可靠。 在此情況下, 建議您將評量切換為內部部署調整大小。

## <a name="monthly-cost-estimation"></a>每月成本預估

調整大小建議完成後, Azure Migrate 會計算遷移後的計算和儲存成本。

- **計算成本**：使用建議的 Azure VM 大小時，Azure Migrate 會使用計費 API 來計算虛擬機器的每月成本。
    - 計算時會將作業系統、軟體保證、保留執行個體、VM 運作時間、位置和貨幣設定納入考量。
    - 它會匯總所有機器的成本, 以計算每月總計算成本。
- **儲存成本**：機器的每月儲存成本計算方式是匯總連接至機器的所有磁片的每月成本, 如下所示:
    - 伺服器評估會匯總所有機器的儲存成本, 以計算每月儲存成本總計。
    - 目前, 計算不會考慮評量設定中指定的供應專案。

成本會以評量設定中指定的貨幣顯示。


## <a name="next-steps"></a>後續步驟

建立[VMware vm](tutorial-assess-vmware.md)或[hyper-v vm](tutorial-assess-hyper-v.md)的評量。
