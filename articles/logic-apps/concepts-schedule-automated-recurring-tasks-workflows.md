---
title: 在 Azure Logic Apps 中排程週期性工作和工作流程
description: 有關使用 Azure Logic Apps 來排定週期性自動化工作、進程和工作流程的總覽
services: logic-apps
ms.service: logic-apps
ms.suite: integration
author: ecfan
ms.author: estfan
ms.reviewer: deli, klam, LADocs
ms.topic: conceptual
ms.date: 05/25/2019
ms.openlocfilehash: 7716c477cea2200e6fee901f7b5f63cd4b833bd7
ms.sourcegitcommit: b2db98f55785ff920140f117bfc01f1177c7f7e2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/16/2019
ms.locfileid: "68232675"
---
# <a name="schedule-and-run-recurring-automated-tasks-processes-and-workflows-with-azure-logic-apps"></a>使用 Azure Logic Apps 來排程和執行循環性的自動化工作、進程和工作流程

Logic Apps 可協助您依排程建立和執行自動化週期性工作和進程。 藉由建立邏輯應用程式工作流程, 其以內建的迴圈觸發程式或滑動視窗觸發程式為開頭, 也就是排程類型的觸發程式, 您可以立即執行工作、稍後或以週期性間隔執行。 您可以呼叫 Azure 內部和外部的服務 (例如 HTTP 或 HTTPS 端點), 將訊息張貼至 Azure 服務 (例如 Azure 儲存體和 Azure 服務匯流排), 或取得上傳至檔案共用的檔案。 使用迴圈觸發程式時, 您也可以設定複雜的排程, 以及執行工作的先進週期。 若要深入瞭解內建的排程觸發程式和動作, 請參閱[排程觸發](#schedule-triggers)程式和[排程動作](#schedule-actions)。 

> [!TIP]
> 您可以排程和執行循環性工作負載, 而不需要為每個排程工作建立個別的邏輯應用程式, 並對[每個區域和訂用帳戶的工作流程限制](../logic-apps/logic-apps-limits-and-config.md#definition-limits)執行。 相反地, 您可以使用[Azure 快速入門範本所建立的邏輯應用程式模式:Logic Apps 作業](https://github.com/Azure/azure-quickstart-templates/tree/master/301-logicapps-jobscheduler/)排程器。
>
> Logic Apps 作業排程器範本會建立一個呼叫 TimerJob 邏輯應用程式的 CreateTimerJob 邏輯應用程式。 接著, 您可以藉由發出 HTTP 要求並將排程傳遞為要求的輸入, 以呼叫 CreateTimerJob 邏輯應用程式作為 API。 CreateTimerJob 邏輯應用程式的每個呼叫也會呼叫 TimerJob 邏輯應用程式, 它會根據指定的排程或直到達到指定的限制, 建立持續執行的新 TimerJob 實例。 如此一來, 您就可以視需要執行多個 TimerJob 實例, 而不必擔心工作流程的限制, 因為實例不是個別的邏輯應用程式工作流程定義或資源。

此清單顯示一些您可以使用排程內建觸發程式來執行的範例工作:

* 取得內部資料, 例如每天執行 SQL 預存程式。

* 取得外部資料, 例如每隔15分鐘從 NOAA 提取氣象報告。

* 傳送報告資料, 例如在過去一周內, 以電子郵件寄出所有大於特定金額的訂單摘要。

* 處理資料, 例如在離峰時段將今日的已上傳影像壓縮為每個工作日。

* 清除資料, 例如刪除三個月之前的所有推文。

* 封存資料, 例如接下來的九個月內每天上午 1:00, 將發票推送到備份服務。

您也可以使用 [排程內建動作], 在下一個動作執行之前暫停工作流程, 例如:

* 等到工作日再透過電子郵件傳送狀態更新。

* 延遲工作流程，直到 HTTP 呼叫有時間來完成，才繼續進行並擷取結果。

本文說明排程內建觸發程式和動作的功能。

<a name="schedule-triggers"></a>

## <a name="schedule-triggers"></a>排程觸發程式

您可以使用 [週期觸發程式] 或 [滑動視窗] 觸發程式來啟動邏輯應用程式工作流程, 這不會與任何特定服務或系統相關聯, 例如 Office 365 Outlook 或 SQL Server。 這些觸發程式會根據您指定的週期啟動並執行您的工作流程, 您可以在其中選取間隔和頻率, 例如兩個觸發程式的秒數、分鐘數和時數, 或是週期觸發程式的天數、周數或月數。 您也可以設定 [開始日期] 和 [時間] 以及 [時區]。 每次引發觸發程式時, Logic Apps 會為您的邏輯應用程式建立並執行新的工作流程實例。

以下是這些觸發程式之間的差異:

* **週期**:根據您指定的排程, 在固定時間間隔執行您的工作流程。 如果遺漏了週期, 迴圈觸發程式不會處理遺漏的週期, 但會在下一個排定的間隔後重新開機。 您可以指定開始日期和時間, 以及時區。 如果您選取 [天], 您可以指定一天中的時數和分鐘數 (例如, 每日 2:30)。 如果您選取 [周], 也可以選取一周中的日子, 例如 [星期三] 和 [星期六]。 如需詳細資訊, 請參閱[使用週期觸發程式建立、排程和執行循環性工作和工作流程](../connectors/connectors-native-recurrence.md)。

* **滑動視窗**:定期執行您的工作流程, 以處理連續區塊中的資料。 如果遺漏了週期, 滑動視窗觸發程式就會回復, 並處理錯過的週期。 您可以指定 [開始日期] 和 [時間]、[時區] 和 [持續時間], 以延遲工作流程中的每個週期。 此觸發程式沒有選項可指定天數、周數和月數、一天的小時、每小時的分鐘數, 以及一周中的天數。 如需詳細資訊, 請參閱[使用滑動視窗觸發程式來建立、排程和執行循環性工作和工作流程](../connectors/connectors-native-sliding-window.md)。

<a name="schedule-actions"></a>

## <a name="schedule-actions"></a>排程動作

在邏輯應用程式工作流程中的任何動作之後, 您可以使用 [延遲] 和 [延遲到] 動作, 讓您的工作流程在下一個動作執行之前等待。

* **延遲**:等候針對指定的時間單位數執行下一個動作, 例如 [秒]、[分鐘]、[小時]、[天]、[周] 或 [月]。 如需詳細資訊, 請參閱[延遲工作流程中的下一個動作](../connectors/connectors-native-delay.md)。

* **延遲到**:等待執行下一個動作, 直到指定的日期和時間為止。 如需詳細資訊, 請參閱[延遲工作流程中的下一個動作](../connectors/connectors-native-delay.md)。

## <a name="patterns-for-start-date-and-time"></a>開始日期和時間的模式

<a name="start-time"></a>

以下是一些模式, 說明如何使用開始日期和時間來控制週期, 以及 Logic Apps 服務執行這些週期的方式:

| 開始時間 | 週期性無排程 | 具有排程的週期 (僅定期觸發程式) |
|------------|-----------------------------|----------------------------------------------------|
| {無} | 立即執行第一個工作負載。 <p>根據上次執行的時間執行未來的工作負載。 | 立即執行第一個工作負載。 <p>根據指定的排程執行未來的工作負載。 |
| 過去的開始時間 | **週期**觸發程式:根據指定的開始時間計算執行時間，並捨棄過去的執行時間。 在未來的下一個執行時間執行第一個工作負載。 <p>根據上次執行時間的計算，執行未來的工作負載。 <p><p>**滑動視窗**觸發程式:根據指定的開始時間計算執行時間, 並接受過去的執行時間。 <p>根據指定開始時間的計算, 執行未來的工作負載。 <p><p>如需詳細說明，請參閱本表格後的範例。 | 根據從開始時間計算的排程，在開始時間「之後」才執行第一個工作負載  。 <p>根據指定的排程執行未來的工作負載。 <p>**注意：** 如果您指定排程的週期，但未指定排程的小時或分鐘，則未來的執行時間會分別使用第一次執行時間之後的小時或分鐘來計算。 |
| 目前或未來的開始時間 | 在指定的開始時間執行第一個工作負載。 <p>根據上次執行時間的計算，執行未來的工作負載。 | 根據從開始時間計算的排程，在開始時間「之後」才執行第一個工作負載  。 <p>根據指定的排程執行未來的工作負載。 <p>**注意：** 如果您指定排程的週期，但未指定排程的小時或分鐘，則未來的執行時間會分別使用第一次執行時間之後的小時或分鐘來計算。 |
||||

*過去開始時間和週期但沒有排程的範例*

假設目前的日期和時間是2017年9月8日下午1:00。 您可以指定開始日期和時間, 如2017年9月7日下午 2:00, 這是過去的, 以及每兩天執行一次的週期。

| 開始時間 | 目前時間 | 週期性 | 排程 |
|------------|--------------|------------|----------|
| 2017-09-**07**T14:00:00Z <br>(2017-09-**07** AT 2:00 PM) | 2017-09-**08**T13:00:00Z <br>(2017-09-**08**下午 1:00) | 每兩天 | {無} |
|||||

針對週期性觸發程式, Logic Apps 引擎會根據開始時間計算執行時間、捨棄過去的執行時間、使用下一個未來的開始時間進行第一次執行, 並根據上次執行時間計算未來的執行。

此週期看起來如下：

| 開始時間 | 第一次執行時間 | 未來的執行時間 |
|------------|----------------|------------------|
| 2017-09-**07**下午 2:00 | 2017-09-**09**下午 2:00 | 2017-09-**11**下午 2:00 </br>2017-09-**13**下午 2:00 </br>2017-09-**15**下午 2:00 </br>依此類推。 |
||||

因此, 無論您在過去有多少時間指定開始時間 (例如, 2017-09-**05**在 2:00 pm 或 2017-09-**01**下午 2:00), 您的第一次執行一律會使用下一個未來的開始時間。

針對滑動視窗觸發程式, Logic Apps 引擎會根據開始時間計算執行時間, 接受過去的執行時間, 使用開始時間進行第一次執行, 並根據開始時間計算未來的執行。

此週期看起來如下：

| 開始時間 | 第一次執行時間 | 未來的執行時間 |
|------------|----------------|------------------|
| 2017-09-**07**下午 2:00 | 2017-09-**07**下午 2:00 | 2017-09-**09**下午 2:00 </br>2017-09-**11**下午 2:00 </br>2017-09-**13**下午 2:00 </br>2017-09-**15**下午 2:00 </br>依此類推。 |
||||

因此, 無論您在過去有多少時間指定開始時間 (例如, 2017-09-**05**在 2:00 pm 或 2017-09-**01**下午 2:00), 您的第一次執行一律會使用指定的開始時間。

<a name="example-recurrences"></a>

## <a name="example-recurrences"></a>重複的範例

以下是您可以為支援選項的觸發程式設定的各種重複範例:

| 觸發程序 | 週期性 | Interval | 頻率 | 開始時間 | 在這幾天內 | 在這幾小時內 | 在這幾分鐘內 | 附註 |
|---------|------------|----------|-----------|------------|---------------|----------------|------------------|------|
| 定期 <br>滑動時間範圍 | 每隔 15 分鐘執行一次 (沒有開始日期和時間) | 15 | Minute | {無} | {無法使用} | {無} | {無} | 此排程會立即開始，然後根據上次執行的時間計算未來的週期。 |
| 定期 <br>滑動時間範圍 | 每隔 15 分鐘執行一次 (有開始日期和時間) | 15 | Minute | *startDate*T*startTime*Z | {無法使用} | {無} | {無} | 此排程不會「早於」  指定的開始日期和時間開始，並且會根據上次執行的時間計算未來的週期。 |
| 定期 <br>滑動時間範圍 | 整點每小時執行一次 (有開始日期和時間) | 1 | Hour | *startDate*Thh:00:00Z | {無法使用} | {無} | {無} | 此排程不會「早於」  指定的開始日期和時間開始。 未來每小時會在 "00" 分鐘標記執行一次週期, 這是從開始時間計算而來。 <p>如果頻率是 [週] 或 [月]，則此排程只會分別在每週的一天或每個月的一天執行。 |
| 定期 <br>滑動時間範圍 | 每天的每個小時執行一次 (沒有開始日期和時間) | 1 | Hour | {無} | {無法使用} | {無} | {無} | 此排程會立即開始，然後根據上次執行的時間計算未來的週期。 <p>如果頻率是 [週] 或 [月]，則此排程只會分別在每週的一天或每個月的一天執行。 |
| 定期 <br>滑動時間範圍 | 每天的每個小時執行一次 (有開始日期和時間) | 1 | Hour | *startDate*T*startTime*Z | {無法使用} | {無} | {無} | 此排程不會「早於」  指定的開始日期和時間開始，並且會根據上次執行的時間計算未來的週期。 <p>如果頻率是 [週] 或 [月]，則此排程只會分別在每週的一天或每個月的一天執行。 |
| 定期 <br>滑動時間範圍 | 每小時的整點過後，每隔 15 分鐘執行一次 (有開始日期和時間) | 1 | Hour | *startDate*T00:15:00Z | {無法使用} | {無} | {無} | 此排程不會「早於」  指定的開始日期和時間開始。 未來的週期會在 "15" 分鐘標記執行, 這是從開始時間計算, 在上午00:15、1:15 AM、2:15 AM 等等。 |
| 週期性 | 每小時的整點過後，每隔 15 分鐘執行一次 (沒有開始日期和時間) | 1 | Day | {無} | {無法使用} | 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23 | 15 | 此排程在上午 00:15、上午 1:15、上午 2:15 (依此類推) 執行。 而且，此排程相當於「小時」的頻率，且開始時間為 "15" 分鐘。 |
| 週期性 | 在指定的分鐘數 (沒有開始日期和時間) 每隔15分鐘執行一次。 | 1 | Day | {無} | {無法使用} | 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23 | 0, 15, 30, 45 | 此排程會在到達下一個指定的 15 分鐘標記處開始。 |
| 週期性 | 每天上午 8:00 執行 (沒有開始日期和時間) | 1 | Day | {無} | {無法使用} | 8 | {無} | 此排程根據指定的排程，在每天的上午 8:00 執行。 |
| 週期性 | 每天上午 8:00 執行 (有開始日期和時間) | 1 | Day | *startDate*T08:00:00Z | {無法使用} | {無} | {無} | 此排程根據指定的開始時間，在每天的上午 8:00 執行。 | 
| 週期性 | 每天上午 8:30 執行 (沒有開始日期和時間) | 1 | Day | {無} | {無法使用} | 8 | 30 | 此排程根據指定的排程，在每天的上午 8:30 執行。 |
| 週期性 | 每天上午 8:30 執行 (有開始日期和時間) | 1 | Day | *startDate*T08:30:00Z | {無法使用} | {無} | {無} | 此排程在指定開始日期的上午 8:30 開始。 |
| 週期性 | 每天上午 8:30 和下午 4:30 執行 | 1 | Day | {無} | {無法使用} | 8, 16 | 30 | |
| 週期性 | 每天上午 8:30、上午 8:45、下午 4:30 及下午 4:45 執行 | 1 | Day | {無} | {無法使用} | 8, 16 | 30, 45 | |
| 週期性 | 每個星期六的下午 5 點執行 (沒有開始日期和時間) | 1 | 週 | {無} | "Saturday" | 17 | 00 | 此排程在每個星期六的下午 5:00 執行。 |
| 週期性 | 每個星期六的下午 5 點執行 (有開始日期和時間) | 1 | 週 | *startDate*T17:00:00Z | "Saturday" | {無} | {無} | 此排程不會「早於」  指定的開始日期和時間開始，在此案例中是 2017 年 9 月 9 日下午 5:00。 未來會在每個星期六的下午 5:00 重複執行。 |
| 週期性 | 每個星期二、星期四的下午 5 點執行 | 1 | 週 | {無} | "Tuesday", "Thursday" | 17 | {無} | 此排程在每個星期二和星期四的下午 5:00 執行。 |
| 週期性 | 在工作時間內的每小時執行一次 | 1 | 週 | {無} | 選取除了星期六和星期日以外的所有日子。 | 選取您想要的整點。 | 選取您想要的任何分鐘。 | 例如，如果您的工作時間是上午 8:00 到下午 5:00，則請選取 "8, 9, 10, 11, 12, 13, 14, 15, 16, 17" 作為整點。 <p>如果您的工作時間是上午 8:30 到下午 5:30，則請選取之前的整點，加上 "30" 作為分鐘。 |
| 週期性 | 週末每天執行一次 | 1 | 週 | {無} | "Saturday", "Sunday" | 選取您想要的整點。 | 視需要選取任何分鐘。 | 此排程會在每個星期六和星期日的指定排程執行。 |
| 週期性 | 只在隔週星期一的每隔 15 分鐘執行一次 | 2 | 週 | {無} | "Monday" | 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23 | 0, 15, 30, 45 | 此排程會在每個其他星期一的每隔 15 分鐘標記處執行一次。 |
| 週期性 | 每月執行 | 1 | 月 | *startDate*T*startTime*Z | {無法使用} | {無法使用} | {無法使用} | 此排程不會  從指定的開始日期和時間開始, 也不會在開始日期和時間計算未來的週期。 如果您未指定開始日期和時間，則此排程會使用建立日期和時間。 |
| 週期性 | 每個月其中一天的每小時執行一次 | 1 | 月 | {請參閱注意} | {無法使用} | 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23 | {請參閱注意} | 如果您未指定開始日期和時間，則此排程會使用建立日期和時間。 若要控制重複排程的分鐘，請指定分鐘、開始時間，或使用建立時間。 例如，如果開始時間或建立時間是上午 8:25，則此排程會在上午 8:25、上午 9:25、上午 10:25 (依此類推) 執行。 |
|||||||||

<a name="run-once"></a>

## <a name="run-one-time-only"></a>僅執行一次

如果您只想要在未來一次執行邏輯應用程式, 您可以使用**排程器:執行作業一次**範本。 當您建立新的邏輯應用程式, 但在開啟 Logic Apps 設計工具之前, 請在 [**範本**] 區段下的 [**類別**] 清單中, 選取 [**排程**], 然後選取此範本:

![選取 [排程器：執行作業一次] 範本](./media/concepts-schedule-automated-recurring-tasks-workflows/choose-run-once-template.png)

或者, 如果您可以使用**收到 HTTP 要求時**的來啟動邏輯應用程式-要求觸發程式, 並將開始時間傳遞為觸發程式的參數。 針對第一個動作, 使用 [**延遲到-排程**] 動作, 並提供下一個動作開始執行的時間。

## <a name="next-steps"></a>後續步驟

* [使用週期觸發程式來建立、排程及執行循環性工作和工作流程](../connectors/connectors-native-recurrence.md)
* [使用滑動視窗觸發程式來建立、排程和執行循環性工作和工作流程](../connectors/connectors-native-sliding-window.md)
* [使用延遲動作暫停工作流程](../connectors/connectors-native-delay.md)
